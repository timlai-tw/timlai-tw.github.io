<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Azure DevOps Services å€‹åˆ¥æœå‹™</title>
    <url>/post/2025/04/azure-devops-individual-services/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/09/azure-devops-individual-services/individual_services.jpg"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p><a href="/post/2024/09/azure-devops-licensing-description">ä¸Šä¸€ç¯‡æ–‡ç« </a>æåˆ°äº† Azure DevOps é›²ç«¯å’Œåœ°ç«¯çš„ä½¿ç”¨è€…æˆæ¬Šï¼Œç•¶æˆ‘å€‘å»ºç«‹ç§æœ‰å°ˆæ¡ˆ (Private project) ä¸”æˆå“¡æ•¸é‡åœ¨ 5 å€‹äººä»¥ä¸‹æ™‚ï¼Œç”šè‡³å¯ä»¥ç›´æ¥å…è²»ä½¿ç”¨ï¼Œå¾ç¬¬ 6 å€‹äººèµ·æ‰éœ€è¦è¨ˆåƒ¹ï¼Œä¸¦å…·æœ‰ 1 Free Microsoft-hosted CI/CD å’Œ 1 Free Self-hosted CI/CD ä»¥åŠ Azure Artifacts 2GB å¯ç”¨å„²å­˜å®¹é‡ã€‚åœ¨å¯¦å‹™ä½¿ç”¨æƒ…å¢ƒè¼ƒè¤‡é›œæ™‚ï¼Œå¾ˆæœ‰å¯èƒ½å°±éœ€è¦å†å¢åŠ å€‹åˆ¥æœå‹™çš„ç”¨é‡ (ä¾‹å¦‚ï¼šAzure Pipelines å¹³è¡Œä½œæ¥­æ•¸é‡)ï¼Œé€™æ¬¡å°±å¸¶å¤§å®¶ç­è§£é€™äº›å€‹åˆ¥æœå‹™è¨ˆåƒ¹çš„æ–¹å¼ã€‚</p>
<span id="more"></span>
<br>
<h2 id="Azure-Pipelines">Azure Pipelines</h2>
<p>ä¸è«–æˆ‘å€‘åœ¨ Azure Pipelines ä½¿ç”¨æ–‡å­—ä»‹é¢æˆ–æ˜¯åœ–å½¢ä»‹é¢ (classic editor) å»ºç«‹ pipeline è…³æœ¬å…§å®¹ï¼Œå…¶ä¸­æœ‰å€‹ <strong><code>Agent pools</code></strong> é¸é …æ˜¯å¿…è¦è¨­å®šï¼Œå®ƒæ˜¯ç”¨ä¾†æ±ºå®šåŸ·è¡Œéšæ®µè¦æŠŠå·¥ä½œ (job) å‚³éåˆ°å“ªå€‹ pool è£¡ï¼Œå°‹æ‰¾é–’ç½®ä¸”ç¬¦åˆæ¢ä»¶çš„ <strong>Azure Pipelines agents</strong> åŸ·è¡Œå€‹é«”ä¾†åŸ·è¡Œè…³æœ¬å…§å®¹ï¼Œåœ¨ Azure DevOps Services é è¨­æœ‰ä¸€å€‹ Microsoft-hosted agent æ¯å€‹æœˆå¯ä»¥å…è²»ä½¿ç”¨ 1800 åˆ†é˜ï¼Œ<mark>ä½†é è¨­ç„¡æ³•ç›´æ¥ä½¿ç”¨</mark>ï¼Œéœ€è¦å¡«å¯« <strong><a class="link"   href="https://aka.ms/azpipelines-parallelism-request" >Azure DevOps Parallelism Request<i class="fas fa-external-link-alt"></i></a></strong> è¡¨å–®ç”³è«‹å¯©æ ¸é€šéæ‰è¡Œï¼Œå¦å‰‡åœ¨åŸ·è¡Œçš„æ™‚å€™æœƒå‡ºç¾å¦‚ä¸‹éŒ¯èª¤ï¼š</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-individual-services/azpipelines-parallelism-request.jpg"
                        class=""
                 >
<p>ç•¶ç„¶æˆ‘å€‘ä¹Ÿå¯ä»¥è‡ªå·±æº–å‚™æ©Ÿå™¨ï¼Œåœ¨ä¸Šé¢å®‰è£ Azure Pipelines agents ç¨‹å¼ (æ”¯æ´ Windows / Linux / macOS)ï¼Œé€™å°±å±¬æ–¼ Self-hosted agentã€‚ç”±æ–¼æ˜¯è‡ªå·±æº–å‚™çš„åŸ·è¡Œå€‹é«”ï¼Œæ‰€ä»¥ä½¿ç”¨æ™‚æ•¸ä¸å—é™åˆ¶ï¼Œä½†æ¯å€‹å·¥ä½œ (job) éƒ½æ˜¯ç¶“ç”±ä½‡åˆ— (queue) çš„æ–¹å¼æ’éšŠä¸€å€‹ä¸€å€‹åŸ·è¡Œï¼Œè‹¥éœ€è¦åŒæ™‚é–“è™•ç†ä¸€å€‹ä»¥ä¸Šçš„å·¥ä½œ (job)ï¼Œå‰‡éœ€è¦å†å¢åŠ åŸ·è¡Œå€‹é«”æ‰è¡Œ (ä¸è«–æ˜¯ Microsoft-hosted æˆ–æ˜¯ Self-hosted)ï¼ŒåŸºæ–¼é€™æ¨£çš„æ¦‚å¿µï¼Œä»¥ä¸‹å°±æ˜¯æˆ‘å€‘æ‰€é—œå¿ƒçš„è¨ˆåƒ¹æ¨™æº–ï¼š</p>
<ul>
<li>æ¯ä¸€å€‹ Microsoft-hosted æ¯å€‹æœˆæœ‰ 1800 åˆ†é˜å¯ä»¥ä½¿ç”¨ã€‚</li>
<li>æ¯å¢åŠ ä¸€å€‹é¡å¤–çš„ Microsoft-hosted CI/CD æ¯å€‹æœˆæ˜¯ USD $40 (å¤§ç´„ <strong>TWD $1279</strong>)ã€‚</li>
<li>æ¯å¢åŠ ä¸€å€‹é¡å¤–çš„ Self-hosted CI/CD æ¯å€‹æœˆæ˜¯ USD $15 (å¤§ç´„ <strong>TWD $479</strong>)ã€‚</li>
<li><mark>å¦‚æœåœ¨åœ°ç«¯è‡ªå»º Azure DevOps Server å‰‡åƒ…èƒ½ä½¿ç”¨ Self-hosted agentï¼Œéœ€è¦æ›´å¤šçš„å¹³è¡Œä½œæ¥­å°±è‡ªå·±å¤šæº–å‚™å¹¾å€‹åŸ·è¡Œå€‹é«”ï¼Œä¸ç”¨å†é¡å¤–æ¡è³¼ä»€éº¼æˆæ¬Šã€‚</mark></li>
</ul>
<h2 id="Azure-Artifacts">Azure Artifacts</h2>
<p>åœ¨è»Ÿé«”å°ˆæ¡ˆé–‹ç™¼éç¨‹ä¸­ï¼Œå¤šå°‘éƒ½æœƒç”¨åˆ°ä¸€äº›å…¬å¸å…§éƒ¨è‡ªè¡Œé–‹ç™¼ï¼Œæˆ–æ˜¯å¤–éƒ¨ä¾†æºæä¾›çš„å¥—ä»¶ï¼Œä¸€èˆ¬å¸¸è¦‹çš„å¥—ä»¶ä¾†æºåƒæ˜¯ï¼šNuGetã€npmã€Mavenã€Pythonâ€¦ç­‰ï¼ŒAzure Artifacts å¯ä»¥å°‡é€™äº›å¤–éƒ¨æä¾›ä¾†æºè¨­ç‚ºä¸Šæ¸¸ä¾†æº (Upstream sources)ï¼Œæˆ–æ˜¯è‡ªå·±å»ºç«‹ä¸€å€‹å¥—ä»¶æä¾›ä¾†æº (Feeds)ï¼Œè®“å°ˆæ¡ˆåœ˜éšŠæˆå“¡åœ¨å…§éƒ¨ç’°å¢ƒå–ç”¨ï¼Œå„²å­˜å®¹é‡åœ¨ 2GB ä»¥å…§æ˜¯å…è²»ï¼Œè‹¥è¶…éå‰‡ä¾ä¸‹åˆ—å€é–“ä»¥é‡è¨ˆåƒ¹ï¼š</p>
<table>
<thead>
<tr>
<th>å„²å­˜å®¹é‡</th>
<th>æ¯GB (USD)</th>
<th>æ¯GB (TWD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>0 - 2 GB</td>
<td>å…è²»</td>
<td>å…è²»</td>
</tr>
<tr>
<td>2 - 10 GB</td>
<td>$2</td>
<td>å¤§ç´„ $63.98</td>
</tr>
<tr>
<td>10 - 100 GB</td>
<td>$1</td>
<td>å¤§ç´„ $31.99</td>
</tr>
<tr>
<td>100 - 1000 GB</td>
<td>$0.50</td>
<td>å¤§ç´„ $16.00</td>
</tr>
<tr>
<td>1000 GB ä»¥ä¸Š</td>
<td>$0.25</td>
<td>å¤§ç´„ NT$8.00</td>
</tr>
</tbody>
</table>
<h2 id="GitHub-Advanced-Security-for-Azure-DevOps">GitHub Advanced Security for Azure DevOps</h2>
<p>ä»¥å¾€æˆ‘å€‘æƒ³è¦å°å°ˆæ¡ˆç¨‹å¼ç¢¼åŸ·è¡ŒåŸç¢¼æª¢æ¸¬ã€å¥—ä»¶æƒæç­‰ä½œæ¥­ï¼Œé¦–å…ˆè¦è€ƒé‡çš„å¯èƒ½æ˜¯ç”¢å“çš„åƒ¹éŒ¢ï¼Œæˆ–æ˜¯å§”å¤–æª¢æ¸¬çš„è²»ç”¨ï¼Œæ¯”è¼ƒå…‹é›£ä¸€é»é‚„å¯ä»¥å°‹æ‰¾å…è²»çš„æƒææª¢æ¸¬å·¥å…·(ä¾‹å¦‚åªæ˜¯æƒ³è¦å‡ºå€‹å ±å‘Š ğŸ™ˆ ğŸ™Š)ï¼Œè‹¥æƒ³è¦æ•´åˆåˆ° CI æµç¨‹è£¡ï¼Œé‚„è¦å¾—é¡å¤–èŠ±ä¸€ç•ªåŠŸå¤«ï¼Œä½†åŸºæœ¬ä¸Šåªè¦å¯ä»¥é€é command line ä¾†åŸ·è¡Œï¼Œéƒ½æ˜¯å¯ä»¥ç”¨ Azure Pipelines æ•´åˆèµ·ä¾†çš„ã€‚è€Œè‡ªå¾ <strong>GitHub Advanced Security for Azure DevOps</strong> æ­£å¼å•Ÿç”¨å¾Œï¼Œçœæ‰äº†é€™éƒ¨ä»½ä¸å°‘éº»ç…©ï¼Œé™¤äº†åŸç”Ÿçš„èˆ‡ Azure DevOps Services æ•´åˆ <mark>(ä¸åŒ…å«åœ°ç«¯ Azure DevOps Server)</mark>ï¼Œä¹Ÿå¯ä»¥èˆ‡ <strong>Microsoft Defender for Cloud</strong> ä¸²æ¥ï¼Œå®ƒå¯ä»¥åšåˆ°ï¼š</p>
<ul>
<li><strong>Code Scanning</strong>ï¼šæ‰¾å‡ºåŸå§‹ç¨‹å¼ç¢¼ä¸­çš„æ¼æ´ä¸¦æä¾›ä¿®å¾©æŒ‡å°ã€‚</li>
<li><strong>Secret Scanning</strong>ï¼šè­˜åˆ¥ secret ä¸¦é˜»æ­¢é–‹ç™¼äººå“¡å°‡ secret æ¨é€åˆ°ç¨‹å¼ç¢¼å„²å­˜åº«ã€‚</li>
<li><strong>Dependency Scanning</strong>ï¼šç™¼ç¾ open-source ä¾è³´é …ç›®çš„æ¼æ´ï¼Œä¸¦ç‚ºé–‹ç™¼äººå“¡è‡ªå‹•ç™¼å‡ºæ›´æ–°è­¦å ±ã€‚</li>
</ul>
<p>åœ¨ Azure Pipelines ä¹Ÿæä¾›äº†ä¸‹åˆ—å°æ‡‰çš„ task ä»¥ä¾¿æˆ‘å€‘å®Œå–„æ•´å€‹ <strong><code>DevSecOps</code></strong> æµç¨‹ï¼š</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-individual-services/github_acvanced_security.jpg"
                        class=""
                 >
<p>é€™å€‹åŠŸèƒ½å¯ä»¥ç”±æ¯å€‹ git çš„å„²å­˜åº« (repositry) å€‹åˆ¥è¨­å®šæ˜¯å¦å•Ÿç”¨ (ä¸æ”¯æ´ TFVC ç‰ˆæ§)ï¼Œè¨ˆåƒ¹çš„åŸå‰‡æ˜¯ï¼šæ¯ä¸€å€‹æ´»èºçš„æäº¤è€… (active committer) æ¯å€‹æœˆ <strong>USD $49</strong> (å¤§ç´„ <strong>TWD $1567</strong>)ï¼Œåœ¨<mark>åŒä¸€å€‹ Azure Subscription</mark> ä¸­ï¼Œå„²å­˜åº«éå» <strong><code>90å¤©</code></strong> çš„ç´€éŒ„ä¸­ï¼ŒåŒä¸€å€‹æäº¤è€…(committer)åœ¨ä¸åŒå°ˆæ¡ˆæäº¤ç¨‹å¼ç¢¼åªæœƒç®— 1 å€‹æ•¸é‡ï¼Œä¸æœƒè¢«é‡è¤‡è¨ˆåƒ¹ã€‚ç•¶æˆ‘å€‘åœ¨ git å„²å­˜åº«é–‹å•Ÿ <strong><code>Advanced Security</code></strong> åŠŸèƒ½æ™‚ï¼ŒAzure DevOps åœ¨ç•«é¢ä¸Šä¹Ÿæœƒå…ˆå¹«æˆ‘å€‘åŸºæ–¼ä¸Šè¿°åŸå‰‡è¨ˆç®—æœ‰å¤šå°‘ä½¿ç”¨è€…æœƒè¢«è¨ˆè²»ï¼Œç¢ºå®šè¦ä½¿ç”¨å†é»é¸ <strong><code>Begin billing</code></strong> å³å¯ï¼š</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-individual-services/unique_committers.jpg"
                        class=""
                 >
<p>å¦‚åŒ Azure å„ç¨®æœå‹™çš„è¨ˆåƒ¹æ–¹å¼ï¼Œéƒ½æ˜¯<strong>éš¨ä»˜å³ç”¨ (pay-as-you-go)</strong>ï¼Œå•Ÿç”¨ <strong>GitHub Advanced Security for Azure DevOps</strong> æ­é… CI æµç¨‹å¯ä»¥è®“æˆ‘å€‘åœ¨é–‹ç™¼éšæ®µåŠæ—©ç™¼ç¾å•é¡Œèˆ‡æ¼æ´ï¼Œæœ‰æ•ˆæ¸›å°‘æŠ€è¡“å‚µå’Œå¾ŒæœŸæŠ•å…¥ä¿®æ”¹çš„äººåŠ›æˆæœ¬ï¼Œè·Ÿæ¸¬è©¦å·¦ç§» (Shift-Left Testing) çš„æ¦‚å¿µæœ‰é»é›·åŒï¼Œä¹Ÿå¯ä»¥çœä¸‹å¤§ç­†è³¼å…¥æºç¢¼æª¢æ¸¬è»Ÿé«”çš„è²»ç”¨ï¼Œå¤§å®¶å¯ä»¥åƒè€ƒçœ‹çœ‹ã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://azure.microsoft.com/zh-tw/pricing/details/devops/azure-devops-services/"  target="_blank">â Azure DevOps å®šåƒ¹<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://azure.microsoft.com/zh-tw/products/devops/github-advanced-security"  target="_blank">â é©ç”¨æ–¼ Azure DevOps çš„ GitHub Advanced Security<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/repos/security/configure-github-advanced-security-features?view=azure-devops&tabs=yaml"  target="_blank">â è¨­å®šé©ç”¨æ–¼ Azure DevOps çš„ GitHub Advanced Security<i class="fas fa-external-link-alt"></i></a>
</font>
</div>]]></content>
      <tags>
        <tag>Azure DevOps</tag>
        <tag>æˆæ¬Š</tag>
      </tags>
  </entry>
  <entry>
    <title>Azure DevOps Services / Server ä½¿ç”¨è€…æˆæ¬Š</title>
    <url>/post/2025/04/azure-devops-licensing-description/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/09/azure-devops-licensing-description/affliction512.jpg"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>Azure DevOps æ˜¯ä¸€å€‹å¯ä»¥è®“æˆ‘å€‘æœ‰æ•ˆç®¡ç†è»Ÿé«”é–‹ç™¼æµç¨‹ï¼ŒåŒæ™‚ç¶­æŒè‰¯å¥½åœ˜éšŠå”ä½œçš„å¼·å¤§å¹³å°ï¼Œé™¤äº†å¯ä»¥ç›´æ¥ä½¿ç”¨é›²ç«¯ Azure DevOps Servicesï¼Œä¹Ÿå¯ä»¥åœ¨åœ°ç«¯è‡ªå»º Azure DevOps Server è®“ä¼æ¥­å…§éƒ¨ç’°å¢ƒä¹Ÿèƒ½æä¾›ç›¸åŒçš„æœå‹™ï¼Œä½†è¨±å¤šäººé‡åˆ°çš„ç¬¬ä¸€å€‹å•é¡Œæ˜¯å¦‚ä½•è³¼è²·æˆæ¬Šæ‰èƒ½è®“æˆæœ¬æ•ˆç›Šæœ€å¤§åŒ–ï¼Ÿé€™ç¯‡æ–‡ç« ä¸»è¦å”åŠ©å¤§å®¶ç­è§£ Azure DevOps åœ¨æˆæ¬Šèˆ‡å®šåƒ¹ä¸Šçš„å…§å®¹ã€‚</p>
<br>
<span id="more"></span>
<br>
<h2 id="Azure-DevOps-Services">Azure DevOps Services</h2>
<p>Azure DevOps æœ‰äº”å€‹ä¸»è¦åŠŸèƒ½ï¼š</p>
<ol>
<li><strong>Azure Boards</strong> (å°ˆæ¡ˆç®¡ç†ã€çœ‹æ¿ç®¡ç†ã€Scrum / Kanbanã€è¨è«–è­°é¡Œ)</li>
<li><strong>Azure Repos</strong> (ç¨‹å¼ç¢¼ç‰ˆæ§ TFVC/git)</li>
<li><strong>Azure Pipelines</strong> (è‡ªå‹•åŒ–å»ºç½®éƒ¨ç½²)</li>
<li><strong>Azure Artifacts</strong> (å¥—ä»¶ç®¡ç†ã€è‡ªå»ºå¥—ä»¶ä¾†æº)</li>
<li><strong>Azure Test Plans</strong> (å»ºç«‹èˆ‡åŸ·è¡Œæ¸¬è©¦è¨ˆåŠƒ)</li>
</ol>
<h3 id="Basic-Plan-èˆ‡-Basic-Test-Plans">Basic Plan èˆ‡ Basic + Test Plans</h3>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-licensing-description/Basic_TestPlans.jpg"
                        class=""
                 >
<p>åœ¨ Azure DevOps å®šåƒ¹é é¢ä¸­çš„ <strong><code>Basic Plan</code></strong> åŒ…å«äº†å‰é¢å››é …åŠŸèƒ½ï¼Œè²»ç”¨æ˜¯ <strong>USD $6</strong> (æ¯å€‹äºº/æœˆ)ï¼ŒæŠ˜åˆå°å¹£å°±è¦çœ‹ç•¶æœˆçš„åŒ¯ç‡è¨ˆç®— (ä¾‹å¦‚ç›®å‰æ˜¯ TWD <strong>$191</strong>)ï¼›ä¸€èˆ¬ä¾†èªªï¼Œåœ¨å°ˆæ¡ˆåœ˜éšŠè£¡ä¸¦ä¸æ˜¯æ¯å€‹æˆå“¡éƒ½éœ€è¦å»ºç«‹èˆ‡ç®¡ç†æ¸¬è©¦è¨ˆåŠƒï¼Œæ‰€ä»¥ <strong>Azure Test Plans</strong> é€™é …åŠŸèƒ½é¡å¤–è¢«æ‹†å‡ºä¾†è¨ˆåƒ¹ï¼Œè‹¥é¸æ“‡ <strong><code>Basic + Test Plans</code></strong> è²»ç”¨å‰‡æ˜¯ <strong>USD $52</strong> (å¤§ç´„ TWD <strong>$1663</strong>)ã€‚</p>
<h3 id="Stakeholder">Stakeholder</h3>
<p>é™¤äº†ä¸Šè¿°å…©ç¨®å­˜å–å±¤ç´š(Access level)ä¹‹å¤–ï¼Œé‚„æœ‰ä¸€ç¨®æ˜¯å…è²»ã€å¯ä½¿ç”¨<mark>æœ‰é™åŠŸèƒ½</mark>çš„ <strong><code>Stakeholder</code></strong>ï¼Œæ¯”è¼ƒç°¡å–®çš„ä¾†èªªï¼Œé€™å€‹å­˜å–å±¤ç´šå¯ä»¥ï¼š</p>
<ul>
<li>å»ºç«‹ / ç·¨è¼¯ / æŸ¥è©¢å·¥ä½œé …ç›®</li>
<li>æª¢è¦– / æ ¸å‡† pipeline</li>
<li>æª¢è¦–æ¸¬è©¦è¨ˆåŠƒ</li>
</ul>
<p>å¦‚åŒå®ƒçš„åç¨±ä¸€æ¨£ï¼šæƒ³è¦ç­è§£å°ˆæ¡ˆè³‡è¨Šï¼Œä½†åˆä¸éœ€è¦å¯¦éš›åƒèˆ‡é–‹ç™¼å¯¦ä½œç´°ç¯€(ä¾‹å¦‚ï¼šå–®ä½ä¸»ç®¡ã€ä½¿ç”¨å–®ä½â€¦ç­‰)ï¼Œå°±ä¸ç”¨å†é¡å¤–æ¡è³¼æˆæ¬Šï¼Œä½¿ç”¨ <strong><code>Stakeholder</code></strong> é€™å€‹å­˜å–å±¤ç´šå°±è¡Œã€‚è‹¥éœ€è¦ <strong>ç¨‹å¼ç¢¼ç‰ˆæ§</strong>ã€<strong>å»ºç«‹/ç·¨è¼¯ pipeline</strong>ã€<strong>åŸ·è¡Œæ¸¬è©¦è¨ˆåŠƒ</strong> é‚£å°±ä¸ç”¨çŒ¶è±«äº†ï¼Œè‡³å°‘ä¸€å®šéœ€è¦ <strong><code>Basic</code></strong> å­˜å–å±¤ç´šæ‰èƒ½ä½¿ç”¨ï¼Œé€™äº›è³‡è¨Šå¯ä»¥åƒé–±ä¸‹åˆ—é€£çµï¼Œåˆ©ç”¨é é¢è£¡çš„å¹£åˆ¥ä¸‹æ‹‰é¸å–®ã€æ‹–æ›³æ•¸é‡æ²è»¸ä¾†å³æ™‚æª¢è¦–è²»ç”¨ä¼°ç®—ï¼Œé é¢æœ€å¾Œé‚„æœ‰ä¸€å€‹é‡å°ä¸åŒå­˜å–å±¤ç´šçš„åŠŸèƒ½æ¯”è¼ƒè¡¨ï¼Œæ–¹ä¾¿å¤§å®¶æŸ¥é–±ã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://azure.microsoft.com/zh-tw/pricing/details/devops/azure-devops-services/"  target="_blank">â Azure DevOps å®šåƒ¹<i class="fas fa-external-link-alt"></i></a>
<br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/organizations/security/stakeholder-access?view=azure-devops"  target="_blank">â é …ç›®é—œä¿‚äººå­˜å–å¿«é€Ÿåƒè€ƒ<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<h3 id="Visual-Studio-Subscription">Visual Studio Subscription</h3>
<p>è‹¥ç›®å‰å·²ç¶“å…·å‚™ <strong>Visual Studio monthly subscription</strong> (æ³¨æ„ï¼š<mark>è¨‚é–±åˆ¶</mark>æ‰è¡Œ)ï¼Œå®ƒä¹ŸåŒ…å«äº† Azure DevOps çš„ä½¿ç”¨æˆæ¬Šï¼ŒåŸºæœ¬ä¸Šå¯ä»¥ç†è§£ç‚ºï¼š<strong>Visual Studio Professional monthly subscription</strong> åŒ…å«äº† <strong><code>Basic Plan</code></strong>ï¼Œè€Œ <strong>Visual Studio Enterprise monthly subscription</strong> åŒ…å«äº† <strong><code>Basic + Test Plans</code></strong>ï¼Œè©³ç´°åŠŸèƒ½æ”¯æ´åˆ—è¡¨å¯ä»¥åƒè€ƒä¸‹åˆ—é€£çµã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/organizations/security/access-levels?view=azure-devops"  target="_blank">â é—œæ–¼å­˜å–å±¤ç´š<i class="fas fa-external-link-alt"></i></a>
<br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=ms.vs-professional-monthly"  target="_blank">â Visual Studio Professional monthly subscription<i class="fas fa-external-link-alt"></i></a>
<br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=ms.vs-enterprise-monthly"  target="_blank">â Visual Studio Enterprise monthly subscription<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<h2 id="Azure-DevOps-Server">Azure DevOps Server</h2>
<p>è¦åœ¨åœ°ç«¯ç’°å¢ƒè‡ªå»º Azure DevOps Server å‰‡éœ€è¦å…ˆæº–å‚™å¥½ SQL Server ç’°å¢ƒï¼Œå…©è€…åœ¨ç‰ˆæœ¬ä¸Šæœ‰ç›¸ä¾æ€§ï¼Œä¾‹å¦‚ï¼šAzure DevOps Server 2022 éœ€è¦æ­é… SQL Server 2019 ä»¥ä¸Š (ä¸æ”¯æ´ Linux ä¸Šçš„ SQL Server)ï¼Œå…¶ä»–ç‰ˆæœ¬èˆ‡ç›¸é—œéœ€æ±‚å»ºè­°å¯ä»¥åƒè€ƒä¸‹åˆ—é€£çµã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/server/requirements?view=azure-devops-2022"  target="_blank">â Azure DevOps å…§éƒ¨éƒ¨ç½²çš„éœ€æ±‚<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<p>ä»¥æˆæ¬Šçš„æ¦‚å¿µä¾†èªªï¼Œå®‰è£å¹¾å° Azure DevOps Server å°±éœ€è¦å¹¾å€‹ Server CALï¼Œå¯ä»¥é€éä¸‹åˆ—å¹¾ç¨®æ–¹å¼å–å¾—åˆæ³•æˆæ¬Šï¼š</p>
<ul>
<li>å‚³çµ±è³¼è²· (<mark>3å¹´SA</mark>) Azure DevOps <mark>Server</mark> CAL</li>
<li>Visual Studio Professional / Enterprise monthly subscription (åŒ…å« Azure DevOps Server CAL)</li>
</ul>
<br>
<p>åœ°ç«¯çš„ä½¿ç”¨è€…æˆæ¬Šå¯ä»¥ç”±ä¸‹åˆ—å¹¾ç¨®æ–¹å¼å–å¾—åˆæ³•æˆæ¬Šï¼š</p>
<ul>
<li>å‚³çµ±è³¼è²· (<mark>3å¹´SA</mark>) Azure DevOps User CAL (åŒ…å« <strong><code>Basic + Test Plans</code></strong> æ‰€æœ‰åŠŸèƒ½)</li>
<li>Visual Studio Professional / Enterprise monthly subscription (åŒ…å« Azure DevOps <mark>User</mark> CAL)</li>
<li>Azure DevOps <strong><code>Basic</code></strong> æˆ– <strong><code>Basic + Test Plans</code></strong> (é›²ç«¯çš„æ¯äººæ¯æœˆè³¼è²·æ–¹å¼ï¼Œä¹ŸåŒ…å«äº†åœ°ç«¯çš„ä½¿ç”¨è€…æˆæ¬Š)</li>
</ul>
<br>
<p>ä»¥ä¸Šæ˜¯å°æ–¼ Azure DevOps Services / Server æˆæ¬Šçš„æ•´ç†èªªæ˜ï¼Œè‹¥å¤§å®¶é‚„æœ‰å…¶ä»–ä¸ç­è§£çš„åœ°æ–¹ï¼Œæ­¡è¿é€éä¸‹æ–¹ç•™è¨€è¨è«–ã€‚ ğŸ˜ƒ</p>
]]></content>
      <tags>
        <tag>Azure DevOps</tag>
        <tag>æˆæ¬Š</tag>
      </tags>
  </entry>
  <entry>
    <title>Azure DevOps REST API èªªæ˜</title>
    <url>/post/2025/04/azure-devops-rest-api/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/09/azure-devops-rest-api/rest_api.jpg"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>ç•¶æˆ‘å€‘è¦è‡ªè¡Œæ“´å……æˆ–ä¸²æ¥ Azure DevOps Services / Server åŠŸèƒ½æ™‚ï¼Œå¯ä»¥é€é Azure DevOps REST API ä¾†é€²è¡Œå®¢åˆ¶é–‹ç™¼ï¼Œä¾‹å¦‚ï¼šæƒ³è¦å¯«ä¸€æ”¯ç¨‹å¼æ¯å¤©ç™¼é€å„å°ˆæ¡ˆåœ¨ç‰ˆæ§å„²å­˜åº«çš„å·®ç•°ç´€éŒ„ï¼Œæˆ–æ˜¯æƒ³è¦åœ¨å…¬å¸å…§éƒ¨è¡¨å–®ç³»çµ±å¯©æ ¸å¾Œï¼Œè§¸ç™¼åŸ·è¡ŒæŒ‡å®šçš„ pipeline â€¦ æ—ç¹ä¸åŠå‚™è¼‰ï¼Œä½¿ç”¨ REST API é€é HTTP å‘¼å«çš„å¥½è™•æ˜¯å¯ä»¥ä¸ç”¨ä¾·é™æ–¼ç‰¹å®šçš„ç¨‹å¼èªè¨€ï¼Œä¹Ÿæ–¹ä¾¿ç”¨ Postman ä¹‹é¡çš„å·¥å…·æ¸¬è©¦ï¼Œé€™ç¯‡æ•´ç†äº†å‘¼å« Azure DevOps REST API çš„å‰ç½®ä½œæ¥­èˆ‡ç›¸é—œèªªæ˜ï¼Œæ–¹ä¾¿å¤§å®¶ä¸Šæ‰‹ğŸ˜ã€‚</p>
<span id="more"></span>
<br>
<h2 id="REST-API">REST API</h2>
<p>ä½¿ç”¨ Azure DevOps REST API æ™‚ï¼Œå…¶ URI è¦æ ¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">VERB https://&#123;instance&#125;/&#123;organization&#125;/&#123;project&#125;/_apis/&#123;area&#125;/&#123;resource&#125;?api-version=&#123;version&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>VERB</strong><br>
èˆ‡ä¸€èˆ¬ RESTful API ç›¸åŒï¼Œåœ¨ä¸²æ¥ Azure DevOps å„ç¨®æƒ…å¢ƒæ™‚ï¼Œ <strong><font color='green'>GET</font></strong> / <strong><font color='brown'>POST</font></strong> / <strong><font color='red'>DELETE</font></strong> / <strong><font color='purple'>PATCH</font></strong> éƒ½æœ‰æ©Ÿæœƒç”¨åˆ°ã€‚</li>
<li><strong>instance</strong><br>
å¦‚æœæ˜¯ä½¿ç”¨é›²ç«¯çš„ Azure DevOps Services æŒ‡çš„å°±æ˜¯ <span>dev.azure.com</span>ï¼Œåœ°ç«¯å‰‡æ˜¯ Azure DevOps Server æ‰€åœ¨çš„ä½å€ã€‚</li>
<li><strong>organization/project</strong><br>
å–æ±ºæ–¼ API ä½œç”¨çš„ç¯„åœï¼Œåœ¨ URI è£¡æœƒæœ‰ organization æˆ– organization/projectï¼Œä¾‹å¦‚ï¼šä½¿ç”¨ API å»ºç«‹å€‹äººæ¬Šæ– (PAT)ï¼Œå‰‡æœƒæ˜¯ï¼š<br>
<strong><font color='brown'>POST</font></strong> https://vssps.dev.azure.com/<mark>{organization}</mark>/_apis/tokens/pats?api-version=7.2<br>
æˆ–è€…åƒæ˜¯ç”¨ API å»ºç«‹ä¸€å€‹å·¥ä½œé …ç›®ï¼Œå‰‡æ˜¯ï¼š<br>
<strong><font color='brown'>POST</font></strong> https://dev.azure.com/<mark>{organization}/{project}</mark>/_apis/wit/workitems/${type}?api-version=7.2</li>
<li><strong>{area}/{resource}</strong><br>
å¾é€™é‚Šå¤§æ¦‚å¯ä»¥çœ‹å‡ºå‘¼å«çš„ API æ˜¯åšå“ªæ–¹é¢çš„æ“ä½œï¼Œä»¥ä¸Šé¢å…©å€‹ä¾‹å­ (å»ºç«‹ PATã€å»ºç«‹ Work item) ä¾†èªªï¼š<br>
<strong><font color='brown'>POST</font></strong> https://vssps.dev.azure.com/{organization}/_apis/<mark>tokens/pats</mark>?api-version=7.2<br>
<strong><font color='brown'>POST</font></strong> https://dev.azure.com/{organization}/{project}/_apis/<mark>wit/workitems/${type}</mark>?api-version=7.2</li>
<li><strong>version</strong><br>
é€šå¸¸æˆ‘å€‘åœ¨ä¸²æ¥ API æ™‚æœƒæ˜ç¢ºæŒ‡å®š versionï¼Œå› ç‚ºæ¯å€‹ TFS / Azure DevOps ç‰ˆæœ¬å°æ–¼ API æ”¯æ´çš„ api-version ä¹Ÿæœ‰æ‰€ä¸åŒ (å¦‚ä¸‹è¡¨)ï¼Œå¦‚æœä¸æŒ‡å®š api-version å‰‡æœƒè‡ªå‹•é¸ç”¨ç›®å‰ç”¢å“æœ€æ–°çš„ç©©å®šç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼šåœ¨ Azure DevOps Server 2019 å®ƒæœƒè‡ªå‹•å–ç”¨ 5.0 ä¾†åŸ·è¡Œï¼Œåœ¨ä¸åŠ  api-version çš„æƒ…æ³ä¸‹ï¼Œè‹¥æ—¥å¾Œå‡ç´šåˆ° Azure DevOps Server 2022ï¼Œå‰‡æœƒè‡ªå‹•å–ç”¨ 7.0 ä¾†åŸ·è¡Œï¼Œç‚ºç¶­æŒä¸²æ¥ç¨‹å¼æ­£å¸¸é‹ä½œï¼Œä¸æœƒå› ç‚º API ç‰ˆæœ¬å·®ç•°è€Œé€ æˆç•°å¸¸ï¼Œä¸€èˆ¬æˆ‘å€‘éƒ½æœƒåŠ ä¸ŠæŒ‡å®šçš„ api-version ç‰ˆè™Ÿã€‚</li>
</ul>
<blockquote>
<p>æé†’å¤§å®¶ï¼š<br>
å¦‚æœæ˜¯ä½¿ç”¨ preview ç‰ˆæœ¬ (ä¾‹å¦‚ï¼š<strong><code>7.2-preview.3</code></strong>)ï¼Œè©² preview ç‰ˆæœ¬æœƒåœ¨ <strong>12 é€±</strong> å¾Œåœç”¨ï¼Œè¢«ç©©å®šçš„æ­£å¼ç‰ˆæœ¬å–ä»£ã€‚</p>
</blockquote>
<table>
<thead>
<tr>
<th>Products</th>
<th style="text-align:center">1.0</th>
<th style="text-align:center">2.0</th>
<th style="text-align:center">3.0</th>
<th style="text-align:center">4.0</th>
<th style="text-align:center">5.0</th>
<th style="text-align:center">6.0</th>
<th style="text-align:center">7.0</th>
</tr>
</thead>
<tbody>
<tr>
<td>Azure DevOps Services</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
</tr>
<tr>
<td>Azure DevOps Server 2022</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
</tr>
<tr>
<td>Azure DevOps Server 2020</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td>Azure DevOps Server 2019</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td>Team Foundation Server 2018</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td>Team Foundation Server 2017</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
<tr>
<td>Team Foundation Server 2015</td>
<td style="text-align:center">V</td>
<td style="text-align:center">V</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
<td style="text-align:center">-</td>
</tr>
</tbody>
</table>
<h2 id="PAT-Personal-Access-Token">PAT (Personal Access Token)</h2>
<p>è¦ä½¿ç”¨ Azure DevOps REST API å­˜å–è³‡æºå‰éƒ½å¿…éœ€å…ˆç¶“éé©—è­‰æˆåŠŸæ‰è¡Œï¼Œå»ºç«‹ <strong><code>å€‹äººå­˜å–æ¬Šæ– (PAT)</code></strong> å¯ä»¥ç®—æ˜¯å®‰å…¨åˆç°¡ä¾¿çš„æ–¹å¼ï¼Œè‹¥æƒ³è¦å¯¦ä½œ OAuth 2.0 æˆ–å…¶ä»–é é¢é©—è­‰æ–¹å¼ï¼Œå¯ä»¥åƒè€ƒä¸‹åˆ—é€£çµï¼š</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/integrate/get-started/authentication/authentication-guidance?toc=%2Fazure%2Fdevops%2Fmarketplace-extensibility%2Ftoc.json&view=azure-devops"  target="_blank">â é¸æ“‡æ­£ç¢ºçš„é©—è­‰æ©Ÿåˆ¶<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<p>è¦å»ºç«‹ä¸€å€‹ PAT å¯ä»¥å¾ Azure DevOps ç•«é¢å³ä¸Šè§’ <strong><code>User settings</code></strong> â†’ <strong><code>Personal access tokens</code></strong> é€²å…¥ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-rest-api/pat.png"
                        class=""
                 >
<br>
<p>é»é¸ <strong><code>+ New Token</code></strong> æŒ‰éˆ•ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-rest-api/pat_1.png"
                        class=""
                 >
<br>
<p>æ¥è‘—å°±æ˜¯ PAT å­˜å–æœŸé™ã€æˆæ¬Šç¯„åœç­‰ç›¸é—œè¨­å®šï¼š</p>
<ul>
<li><strong>Organization</strong><br>
é¸æ“‡ <strong>ç‰¹å®šçš„ Organization</strong> æˆ– <strong>All accessible organizations</strong> (å…è¨±å­˜å–å…¨éƒ¨çµ„ç¹”)ã€‚</li>
<li><strong>Expiration (UTC)</strong><br>
æœ‰æ•ˆæœŸé™å¯ä»¥é¸æ“‡ <strong>30 / 60 / 90 å¤©</strong>ï¼Œæˆ–æ˜¯ <strong>Custom defined</strong> (<mark>æœ€é•·åªèƒ½ä¸€å¹´</mark>)</li>
<li><strong>Scopes</strong><br>
å¯ä»¥é¸æ“‡ <strong>Full access</strong> (å…è¨±å­˜å–å…¨éƒ¨ç¯„åœ) æˆ– <strong>Custom defined</strong> é‡å°å„å€‹åŠŸèƒ½é€²ä¸€æ­¥è¨­å®šï¼ŒåŸºæ–¼æœ€ä½æ¬Šé™åŸå‰‡ï¼Œå»ºè­°å¤§å®¶å¯ä»¥æœ‰æ„ç¾©çš„å‘½å token åç¨±ï¼Œä¸¦ä¸”åªå‹¾é¸å¿…è¦çš„ <strong>Scopes</strong> æˆæ¬Šç¯„åœã€‚</li>
</ul>
<p>å»ºç«‹ PAT å¾Œï¼Œåƒ…èƒ½ <strong><code>Revoke</code></strong> (æ’¤éŠ·) æˆ–æ˜¯ <strong><code>Regenerate</code></strong> (é‡æ–°ç”¢ç”Ÿ)ï¼Œæ²’æœ‰è¾¦æ³•å†ç”¨ä»»ä½•æ–¹å¼æª¢è¦–åŸæœ¬ç”¢ç”Ÿçš„ token å…§å®¹ï¼Œå¤§å®¶è¨˜å¾—è¦å¦¥å–„ä¿å­˜ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-rest-api/pat_2.png"
                        class=""
                 >
<h2 id="NET-Client-Library">.NET Client Library</h2>
<p>å¦‚æœæ˜¯ä½¿ç”¨ .NET é€²è¡Œç¨‹å¼é–‹ç™¼ï¼Œé‚„æœ‰ä¸€å€‹é¸æ“‡æ˜¯å¾ NuGet.org ä¸‹è¼‰ Client library ä½¿ç”¨ï¼Œå¥—ä»¶ç›¸ä¾é—œä¿‚å¦‚ä¸‹åœ–ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-rest-api/dotnet-client-libraries-dependancy-diagram.jpg"
                        class=""
                 >
<br>
<p>æœ€æ–°ç‰ˆæœ¬å¯ä»¥ç”± NuGet.org æŸ¥è©¢çµæœæ‰¾åˆ°ï¼š https://www.nuget.org/packages?q=azure+devops+.net ï¼Œå¥—ä»¶å’Œ Azure DevOps ç‰ˆæœ¬ä¸€æ¨£æœ‰ç›¸ä¾æ€§ï¼Œ ä½¿ç”¨å‰è¦ç•™æ„ä¸€ä¸‹ç›®å‰ç’°å¢ƒçš„ TFS / Azure DevOps Server ç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼šAzure DevOps Server 2019 åªèƒ½ä½¿ç”¨åˆ°å¥—ä»¶ 16.143.x ç‰ˆã€‚</p>
<table>
<thead>
<tr>
<th>å¥—ä»¶ç‰ˆæœ¬</th>
<th>Azure DevOps ç‰ˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>16.205.x</td>
<td>versions &gt;= Azure DevOps Server 2022</td>
</tr>
<tr>
<td>16.170.x</td>
<td>versions &gt;= Azure DevOps Server 2020</td>
</tr>
<tr>
<td>16.153.x</td>
<td>versions &gt;= Azure DevOps Server 2019 Update 1</td>
</tr>
<tr>
<td>16.143.x</td>
<td>versions &gt;= Azure DevOps Server 2019</td>
</tr>
<tr>
<td>15.131.x</td>
<td>versions &gt;= TFS 2018 Update 1</td>
</tr>
<tr>
<td>15.112.x</td>
<td>versions &gt;= TFS 2017 Update 1</td>
</tr>
<tr>
<td>14.102.x</td>
<td>versions &gt;= TFS 2015 Update 3</td>
</tr>
<tr>
<td>14.95.x</td>
<td>versions &gt;= TFS 2015 Update 2</td>
</tr>
<tr>
<td>14.89.x</td>
<td>versions &gt;= TFS 2015 Update 1</td>
</tr>
<tr>
<td>14.83.x</td>
<td>versions &gt;= TFS 2015</td>
</tr>
</tbody>
</table>
<p>åœ¨å¯¦å‹™é–‹ç™¼ä¸Šé‚„æ˜¯å¾—èŠ±äº›æ™‚é–“å…ˆç­è§£å¥—ä»¶å®šç¾©äº†å“ªäº› classã€æä¾›äº†ä»€éº¼ functionï¼Œé€™éƒ¨ä»½å¯ä»¥åƒè€ƒå®˜æ–¹èªªæ˜å’Œ github sample codeï¼Œå¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚æˆ–ç’°å¢ƒè€ƒé‡éœ€è¦ä½¿ç”¨çš„è©±ï¼Œå¯ä»¥åƒè€ƒä¸‹åˆ—é€£çµï¼š</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/integrate/concepts/dotnet-client-libraries?view=azure-devops&viewFallbackFrom=vsts"  target="_blank">â .NET ç”¨æˆ¶ç«¯ç¨‹å¼åº«<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/integrate/get-started/client-libraries/samples?view=azure-devops"  target="_blank">â C# ç”¨æˆ¶ç«¯é€£çµåº«ç¯„ä¾‹<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://github.com/microsoft/azure-devops-dotnet-samples"  target="_blank">â .NET samples for Azure DevOps<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<p>(ğŸ’ çœ‹å®Œä¸Šé¢é€£çµå…§å®¹æœ‰æ²’æœ‰è¦ºå¾—é‚„æ˜¯ä½¿ç”¨ REST API æ¯”è¼ƒæ–¹ä¾¿ ğŸ’–)</p>
]]></content>
      <tags>
        <tag>Azure DevOps</tag>
        <tag>Azure DevOps REST API</tag>
        <tag>PAT</tag>
        <tag>.NET Client Library</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Azure DevOps REST API å»ºç«‹å°ˆæ¡ˆ</title>
    <url>/post/2025/04/azure-devops-create-project/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/09/azure-devops-create-project/create-project.png"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>è¦ä½¿ç”¨ Azure DevOps å„é …åŠŸèƒ½ä¹‹å‰ï¼Œé¦–å…ˆå¾—å…ˆå»ºç«‹ä¸€å€‹å°ˆæ¡ˆï¼ŒåŒæ™‚å¿…é ˆé¸æ“‡å°ˆæ¡ˆçš„ç‰ˆæœ¬æ§åˆ¶æ˜¯ <strong>TFVC</strong> (Team Fundation Version Control) é‚„æ˜¯ <strong>git</strong>ï¼Œä»¥åŠå°ˆæ¡ˆè¦ä½¿ç”¨çš„æµç¨‹ç¯„æœ¬ (Process template)ï¼Œé è¨­æœ‰ <strong>Basic / Agile / Scrum / CMMI</strong> å››ç¨®ï¼Œé€™æ¬¡æˆ‘å€‘å°±ä¸é€éç¶²é ä»‹é¢å»ºç«‹å°ˆæ¡ˆï¼Œç›´æ¥ä½¿ç”¨ API å°è©¦èº«æ‰‹ ğŸ£ ã€‚</p>
<br>
<span id="more"></span>
<br>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>ç•¶æˆ‘å€‘æƒ³è¦ä½¿ç”¨ <strong>Azure DevOps REST API</strong> é€²è¡Œç¨‹å¼ä¸²æ¥æ™‚ï¼Œé¦–å…ˆè¦ç¢ºèªä½¿ç”¨æƒ…å¢ƒæ˜¯ <strong><code>é›²ç«¯</code></strong> é‚„æ˜¯ <strong><code>åœ°ç«¯</code></strong>ï¼Œå› ç‚ºå…©è€…å°æ–¼ API çš„æ”¯æ´ç¨‹åº¦ä¸ç›¡ç›¸åŒï¼Œä¾‹å¦‚ï¼š<strong>Audit log</strong> ç›®å‰åªæœ‰åœ¨é›²ç«¯æ‰èƒ½æŸ¥è©¢ã€ä¸‹è¼‰ï¼Œåœ°ç«¯é‚„æ²’æœ‰æ”¯æ´ï¼Œä½¿ç”¨å“ªä¸€ç‰ˆçš„ API ä¹Ÿè¦ç¨å¾®ç•™æ„(åœ¨<a href="/post/2024/09/azure-devops-rest-api">ä¸Šä¸€ç¯‡æ–‡ç« </a>æœ‰èªªæ˜åŸå› )ï¼Œé€™äº›éƒ½å¯ä»¥åœ¨ API èªªæ˜é é¢å·¦ä¸Šè§’é€éä¸‹æ‹‰é¸å–®ä¾†å¿«é€Ÿåˆ‡æ›æª¢è¦–ï¼Œä»¥ä¾¿æˆ‘å€‘ç¢ºèª API è¦æ ¼èˆ‡å·®ç•°ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/version_dropdown.png"
                        class=""
                 >
<br>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/en-us/rest/api/azure/devops/?view=azure-devops-rest-7.2"  target="_blank">â Azure DevOps Services REST API Reference<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<br>
<h2 id="API-è¦æ ¼ç¢ºèª">API è¦æ ¼ç¢ºèª</h2>
<p>ç¶“ç”±ä¸Šé¢çš„åƒè€ƒé€£çµï¼Œæˆ‘å€‘å¯ä»¥åœ¨ <strong>Core &gt; Projects &gt; Create</strong> æ‰¾åˆ°å»ºç«‹å°ˆæ¡ˆçš„ API è¦æ ¼ï¼š</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">é›²ç«¯</span><br><span class="line">POST https://dev.azure.com/&#123;organization&#125;/_apis/projects?api-version=7.2-preview.4</span><br></pre></td></tr></table></figure>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">åœ°ç«¯</span><br><span class="line">POST https://&#123;instance&#125;/&#123;collection&#125;/_apis/projects?api-version=7.0</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/core_projects_create.png"
                        class=""
                 >
<br>
<p>åœ¨é é¢ä¸Šå°æ–¼ Request Body çš„å±¬æ€§å’Œå‹åˆ¥å®£å‘Šéƒ½æœƒé€ä¸€èªªæ˜ï¼Œä½†å”¯ä¸€ç¾ä¸­ä¸è¶³çš„æ˜¯æˆ‘å€‘çœ‹ä¸å‡ºä¾†å“ªäº›å±¬æ€§æ˜¯å¿…è¦é …ç›®(Required)ï¼Œæ¯”è¼ƒç°¡ä¾¿çš„æ–¹å¼æ˜¯å¯ä»¥ä½¿ç”¨ Postman å¡«å…¥ PAT é©—è­‰å¾Œé€²è¡Œæ¸¬è©¦ï¼Œé€šå¸¸åœ¨ Reponse éƒ½æœƒå‘Šè¨´æˆ‘å€‘ç¼ºå°‘ä»€éº¼å¿…è¦æ¬„ä½å€¼ï¼ŒPostman è¨­å®šæ­¥é©Ÿå¦‚ä¸‹ï¼š</p>
<br>
<ol>
<li>Authorization çš„ Auth Type é¸æ“‡ <strong><code>Basic Auth</code></strong>ï¼Œä¸¦å°‡ PAT å¡«å…¥ Password æ¬„ä½ï¼ŒUsername ç©ºç™½å³å¯ã€‚(å¦‚ä½•å»ºç«‹ PAT å¯ä»¥åƒè€ƒï¼š<a href="/post/2024/09/azure-devops-rest-api">ä¸Šä¸€ç¯‡æ–‡ç« </a>)</li>
</ol>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/basic_auth.png"
                        class=""
                 >
<br>
<ol start="2">
<li>Headers çš„ Content-Type è¨­å®š <strong><code>application/json</code></strong>ã€‚</li>
</ol>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/content_type.png"
                        class=""
                 >
<br>
<ol start="3">
<li>Body æ ¼å¼é¸æ“‡ <strong><code>raw</code></strong> å’Œ <strong><code>JSON</code></strong>ï¼Œå…§å®¹å…ˆè¼¸å…¥ <strong><code>&#123;&#125;</code></strong> ç„¶å¾ŒæŒ‰ä¸‹ <strong><code>Send</code></strong> æŒ‰éˆ•ã€‚</li>
</ol>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/400_bad.png"
                        class=""
                 >
<br>
<p>ç”± message å›å‚³çš„è³‡è¨Šæˆ‘å€‘å°±å¯ä»¥å¾—çŸ¥ï¼Œå¿…è¦çš„å±¬æ€§æœ‰ï¼š</p>
<ul>
<li><strong>name</strong> : å°ˆæ¡ˆåç¨±</li>
<li><strong>description</strong>: å°ˆæ¡ˆæè¿°èªªæ˜</li>
<li><strong>visibility</strong> : å°ˆæ¡ˆå¯å±¤ç´š (Publicæˆ–Privateï¼Œé è¨­æ˜¯Private)</li>
<li><strong>capabilities</strong> : ç‰ˆæ§æ–¹å¼ã€æµç¨‹ç¯„æœ¬æ˜¯å¿…è¦é …ç›®ã€‚</li>
</ul>
<p>å®Œæ•´çš„ Request Body å…§å®¹å¯ä»¥åƒè€ƒä¸‹åˆ—å…§å®¹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MyNewProject&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;This is a new project created via API&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;capabilities&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;versioncontrol&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;sourceControlType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Git&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;processTemplate&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;templateTypeId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;6b724908-ef14-45cf-84f8-768b5384da45&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<br>
<p>é€å‡º Request æˆåŠŸå¾Œï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹è¨Šæ¯ï¼š</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/202_accepted.png"
                        class=""
                 >
<br>
<p>é–‹å•Ÿ Azure DevOps ç•«é¢ç¢ºèªæ–°å¢çš„å°ˆæ¡ˆæ˜¯å¦æœ‰æ­£å¸¸å‡ºç¾ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/my_new_project.png"
                        class=""
                 >
<h2 id="æµç¨‹ç¯„æœ¬-Process-template">æµç¨‹ç¯„æœ¬ (Process template)</h2>
<p>åœ¨ Azure DevOps é è¨­æœ‰ <strong>Basic / Agile / Scrum / CMMI</strong> å››ç¨®æµç¨‹ç¯„æœ¬ï¼Œä¸€èˆ¬æˆ‘æœ¬å¹¾ä¹ä¸æœƒå»é—œå¿ƒå®ƒçš„ templateTypeId (GUID) æ˜¯ä»€éº¼ï¼Œé€™é‚Šéœ€è¦é€éå¦ä¸€æ”¯æŸ¥è©¢ Process template åˆ—è¡¨çš„ API ä¾†å–å¾—è³‡è¨Šï¼š</p>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">é›²ç«¯</span><br><span class="line">GET GET https://dev.azure.com/&#123;organization&#125;/_apis/process/processes?api-version=7.2-preview.1</span><br></pre></td></tr></table></figure>
<figure class="highlight http"><table><tr><td class="code"><pre><span class="line">åœ°ç«¯</span><br><span class="line">GET https://&#123;instance&#125;/&#123;collection&#125;/_apis/process/processes?api-version=7.0</span><br></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;count&quot;</span><span class="punctuation">:</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;adcc42ab-9882-485e-a3ed-7678f01f66bc&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;This template is flexible and will work great for most teams using Agile planning methods, including those practicing Scrum.&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://devopssrv/DefaultCollection/_apis/process/processes/adcc42ab-9882-485e-a3ed-7678f01f66bc&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Agile&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;27450541-8e31-4150-9947-dc59f998fc01&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;This template is for more formal projects requiring a framework for process improvement and an auditable record of decisions.&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://devopssrv/DefaultCollection/_apis/process/processes/27450541-8e31-4150-9947-dc59f998fc01&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CMMI&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;b8a3a935-7e91-48b8-a94c-606d37c3e9f2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;This template is flexible for any process and great for teams getting started with Azure DevOps.&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://devopssrv/DefaultCollection/_apis/process/processes/b8a3a935-7e91-48b8-a94c-606d37c3e9f2&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Basic&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;6b724908-ef14-45cf-84f8-768b5384da45&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;This template is for teams who follow the Scrum framework.&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;isDefault&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;system&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;url&quot;</span><span class="punctuation">:</span> <span class="string">&quot;http://devopssrv/DefaultCollection/_apis/process/processes/6b724908-ef14-45cf-84f8-768b5384da45&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Scrum&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="å¾Œè¨˜">å¾Œè¨˜</h2>
<p>å†å›éé ­ä¾†çœ‹ï¼Œå…¶å¯¦æˆ‘å€‘ä¸Šé¢åšçš„é€™äº›å‹•ä½œå°±æ˜¯ä»¥ API çš„æ–¹å¼é€å‡ºç•«é¢ä¸Šå»ºç«‹å°ˆæ¡ˆçš„å¿…è¦æ¬„ä½è€Œå·²ï¼š</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/azure-devops-create-project/new_project.png"
                        class=""
                 >
<br>
<p>é™„å¸¶ä¸€æï¼Œè‹¥æ˜¯ä»¥ C# å¯¦ä½œï¼Œåœ¨ Header å‚³é PAT éœ€è¦å…ˆä»¥ <strong>Base64</strong> ç·¨ç¢¼æ‰è¡Œï¼Œå¯ä»¥åƒè€ƒä¸‹åˆ—å®Œæ•´ç¯„ä¾‹å‘¼å«ç¯„ä¾‹(ç¬¬31è¡Œ)ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Collections.Generic;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http;</span><br><span class="line"><span class="keyword">using</span> System.Net.Http.Headers;</span><br><span class="line"><span class="keyword">using</span> System.Text;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> Newtonsoft.Json;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProcessTemplate</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">public</span> <span class="built_in">string</span> Id &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">		<span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ProcessTemplatesResponse</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">public</span> List&lt;ProcessTemplate&gt; Value &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">async</span> Task <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] args</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">string</span> pat = <span class="string">&quot;...&quot;</span>;</span><br><span class="line">		<span class="built_in">string</span> serverName = <span class="string">&quot;...&quot;</span>;</span><br><span class="line">		<span class="built_in">string</span> collectionName = <span class="string">&quot;...&quot;</span>;</span><br><span class="line">		<span class="built_in">string</span> url = <span class="string">$&quot;http://<span class="subst">&#123;serverName&#125;</span>/<span class="subst">&#123;collectionName&#125;</span>/_apis/process/processes?api-version=7.0&quot;</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">using</span> (HttpClient client = <span class="keyword">new</span> HttpClient())</span><br><span class="line">		&#123;</span><br><span class="line">			client.DefaultRequestHeaders.Authorization = <span class="keyword">new</span> AuthenticationHeaderValue(<span class="string">&quot;Basic&quot;</span>, Convert.ToBase64String(Encoding.ASCII.GetBytes(<span class="string">$&quot;:<span class="subst">&#123;pat&#125;</span>&quot;</span>)));</span><br><span class="line">			HttpResponseMessage response = <span class="keyword">await</span> client.GetAsync(url);</span><br><span class="line"></span><br><span class="line">			<span class="keyword">if</span> (response.IsSuccessStatusCode)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">string</span> result = <span class="keyword">await</span> response.Content.ReadAsStringAsync();</span><br><span class="line">				<span class="keyword">var</span> processTemplates = JsonConvert.DeserializeObject&lt;ProcessTemplatesResponse&gt;(result);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">foreach</span> (<span class="keyword">var</span> process <span class="keyword">in</span> processTemplates.Value)</span><br><span class="line">				&#123;</span><br><span class="line">					Console.WriteLine(<span class="string">$&quot;Name: <span class="subst">&#123;process.Name&#125;</span>, ID: <span class="subst">&#123;process.Id&#125;</span>&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				Console.WriteLine(<span class="string">$&quot;Failed to get process templates: <span class="subst">&#123;response.StatusCode&#125;</span>&quot;</span>);</span><br><span class="line">				<span class="built_in">string</span> error = <span class="keyword">await</span> response.Content.ReadAsStringAsync();</span><br><span class="line">				Console.WriteLine(error);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<br>
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/azure/devops/integrate/how-to/call-rest-api?view=azure-devops"  target="_blank">â é–‹å§‹ä½¿ç”¨ REST API
<i class="fas fa-external-link-alt"></i></a>
</font>
</div>]]></content>
      <tags>
        <tag>Azure DevOps</tag>
        <tag>Azure DevOps REST API</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Playwright æ¸¬è©¦æ¡†æ¶ - ç’°å¢ƒæº–å‚™ (.NET)</title>
    <url>/post/2025/05/how-to-use-playwright-1/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/11/how-to-use-playwright-1/playwright.png"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>åœ¨ç¾ä»£è»Ÿé«”é–‹ç™¼ä¸­ï¼Œè‡ªå‹•åŒ–æ¸¬è©¦å·²æˆç‚ºç¢ºä¿ç¨‹å¼ç¢¼å“è³ªçš„é‡è¦ä¸€ç’°ï¼ŒPlaywright æ˜¯ä¸€å€‹å¼·å¤§çš„è‡ªå‹•åŒ–æ¸¬è©¦æ¡†æ¶ï¼Œæ”¯æ´ Chromium / Firefox / WebKit ç€è¦½å™¨ï¼Œæ­é…æ¸¬è©¦ç”¢ç”Ÿå™¨(codegen)è®“é–‹ç™¼è€…èƒ½å¤ è¼•é¬†æ’°å¯«å¯é ä¸”é«˜æ•ˆçš„æ¸¬è©¦è…³æœ¬ã€‚æœ¬ç¯‡æ–‡ç« å°‡ä»‹ç´¹å¦‚ä½•åœ¨ .NET é–‹ç™¼ç’°å¢ƒä¸­è¨­ç½®å’Œä½¿ç”¨ Playwrightï¼Œå¾å®‰è£å¿…è¦çš„å¥—ä»¶åˆ°æ’°å¯«åŸºæœ¬çš„æ¸¬è©¦æ¡ˆä¾‹ï¼Œå¹«åŠ©å¤§å®¶å¿«é€Ÿä¸Šæ‰‹é€™å€‹å·¥å…·ã€‚<br>
<br></p>
<span id="more"></span>
<br>
<h2 id="ä½¿ç”¨-Visual-Studio">ä½¿ç”¨ Visual Studio</h2>
<p>å¦‚æœæ˜¯æ…£ç”¨åœ°è¡¨æœ€å¼·é–‹ç™¼å·¥å…·ï¼Œæ‰“é–‹ Visual Studio å»ºç«‹ä¸€å€‹æ–°çš„ <strong><code>MSTest æ¸¬è©¦å°ˆæ¡ˆ</code></strong>ï¼Œè®“æˆ‘å€‘æœ‰ä¸€å€‹åŸºæœ¬æ¸¬è©¦ç’°å¢ƒå¯ä»¥é–‹å§‹æ’°å¯« Playwright æ¸¬è©¦ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/vs-01.png"
                        class=""
                 >
<br>
<p>è¦åœ¨ MSTest ä½¿ç”¨ Playwright å¿…éœ€è¦å®‰è£ <strong><code>Microsoft.Playwright.MSTest</code></strong> å¥—ä»¶ï¼Œé€™å€‹å¥—ä»¶æœƒå°‡ Playwright èˆ‡ MSTest æ•´åˆï¼Œä½¿æˆ‘å€‘èƒ½å¤ åœ¨ MSTest æ¸¬è©¦éç¨‹ä¸­ä½¿ç”¨ Playwright åŠŸèƒ½ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/vs-02.png"
                        class=""
                 >
<h2 id="ä½¿ç”¨-NET-CLI">ä½¿ç”¨ .NET CLI</h2>
<p>è‹¥æ˜¯ä½¿ç”¨ VSCode é–‹ç™¼å·¥å…·ï¼Œæˆ‘å€‘å¯ä»¥ç”¨ <strong>dotnet new</strong> æŒ‡ä»¤æ–°å¢ä¸€å€‹ PlaywrightTests å°ˆæ¡ˆï¼Œé è¨­å…§å®¹æœƒåŒ…å«ä¸€å€‹ UnitTest1.cs æª”æ¡ˆã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet new mstest -n PlaywrightTests</span><br><span class="line">cd PlaywrightTests</span><br></pre></td></tr></table></figure>
<p>å®‰è£å¿…è¦çš„ Playwright ç›¸ä¾å¥—ä»¶ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet add package Microsoft.Playwright.MSTest</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/cli-01.png"
                        class=""
                 >
<br>
<p>å»ºç½®ç¨‹å¼ç¢¼ï¼Œç¢ºèªç’°å¢ƒæº–å‚™æ˜¯å¦æœ‰ç•°å¸¸ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet build</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/cli-02.png"
                        class=""
                 >
<br>
<h2 id="å®‰è£-Playwright-CLI">å®‰è£ Playwright CLI</h2>
<p>åœ¨ .NET é–‹ç™¼ç’°å¢ƒä¸­ï¼Œé›–ç„¶ <strong>playwright.exe</strong> æŒ‡ä»¤æ²’æœ‰åƒ <strong>npx playwright</strong> é‚£éº¼å¤šåƒæ•¸èˆ‡åŠŸèƒ½ï¼Œä½†æˆ‘å€‘åœ¨éŒ„è£½ç¶²é æ“ä½œéç¨‹ä¾†ç”¢ç”Ÿæ¸¬è©¦ç¨‹å¼ç¢¼ (codegen)ï¼Œæˆ–æ˜¯é–‹å•Ÿè¿½è¹¤æª” (show-trace) æ™‚ä»æœƒä½¿ç”¨åˆ°ï¼Œå¯ä»¥é€éä¸‹åˆ—æŒ‡ä»¤ä¾†å®‰è£ <strong><code>Microsoft.Playwright.CLI</code></strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet tool install --global Microsoft.Playwright.CLI</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°å¥—ä»¶é è¨­æœƒè¢«å®‰è£åˆ°ç›®å‰çš„ä½¿ç”¨è€…ç¯„åœå…§çš„ .NET å…¨å±€å·¥å…·è·¯å¾‘ä¸­ï¼Œå…·é«”å®‰è£ä½ç½®æœƒå› ä½œæ¥­ç³»çµ±è€Œç•°ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Windows</span><br><span class="line">C:\Users\&lt;ä½ çš„ç”¨æˆ¶å&gt;\.dotnet\tools\</span><br><span class="line"></span><br><span class="line">Linux / macOS</span><br><span class="line">/home/&lt;ä½ çš„ç”¨æˆ¶å&gt;/.dotnet/tools/</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/cli-03.png"
                        class=""
                 >
<p>æˆ‘å€‘å¯ä»¥ç›´æ¥é–‹å•Ÿç›®éŒ„ç¢ºèªå·¥å…·æ˜¯å¦å®‰è£æˆåŠŸï¼Œæˆ–æ˜¯ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ä¾†åˆ—å‡ºæ‰€æœ‰å®‰è£çš„ .NET å·¥å…·ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet tool list --global</span><br></pre></td></tr></table></figure>
<p>ä¾‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Package Id                    Version      Commands</span><br><span class="line">-----------------------------------------------------</span><br><span class="line">dotnet-ef                     8.0.8        dotnet-ef</span><br><span class="line">microsoft.playwright.cli      1.2.3        playwright</span><br></pre></td></tr></table></figure>
<h2 id="ç§»é™¤-Playwright-CLI">ç§»é™¤ Playwright CLI</h2>
<p>è‹¥éœ€è¦ç§»é™¤å·²å®‰è£çš„å¥—ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹åˆ—æŒ‡ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dotnet tool uninstall microsoft.playwright.cli</span><br></pre></td></tr></table></figure>
<h2 id="å®‰è£-Playwright-æ”¯æ´çš„ç€è¦½å™¨">å®‰è£ Playwright æ”¯æ´çš„ç€è¦½å™¨</h2>
<p>Playwright æ”¯æ´ Chromiumã€WebKit å’Œ Firefox ç€è¦½å™¨ï¼Œæˆ‘å€‘å¯ä»¥ä½¿ç”¨ <strong>playwright install</strong> æŒ‡ä»¤ä¾†å®‰è£é è¨­ç€è¦½å™¨ï¼Œé€™å€‹å‹•ä½œæœƒå°‡ç€è¦½å™¨å®‰è£åˆ° <strong><mark>%LOCALAPPDATA%\ms-playwright</mark></strong> ç›®éŒ„ä¸‹ï¼Œè‹¥æƒ³è¦è‡ªè¨‚å®‰è£çš„é …ç›®ï¼Œå¯ä»¥é€é <strong>playwright help install</strong> ä¾†ç­è§£æ‰€æœ‰çš„é¸é …ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">playwright install</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/cli-04.png"
                        class=""
                 >
<br>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">playwright help install</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-1/cli-05.png"
                        class=""
                 >
<h2 id="å°è©¦èº«æ‰‹">å°è©¦èº«æ‰‹</h2>
<p>ä»¥ä¸Š Playwright ç’°å¢ƒè¨­å®šéƒ½å®Œæˆå¾Œï¼Œæˆ‘å€‘å°±å¯ä»¥ç›´æ¥ç”¨å®˜ç¶²çš„ç¬¬ä¸€å€‹ç¯„ä¾‹ä¾†å°è©¦èº«æ‰‹ï¼š</p>
<ul>
<li>
<p><code>HasTitle()</code><br>
æ‰“é–‹ Playwright å®˜æ–¹ç¶²ç«™ï¼Œæª¢æŸ¥ç¶²ç«™çš„æ¨™é¡Œæ˜¯å¦åŒ…å«ç‰¹å®šçš„å­—ä¸²ï¼Œç¢ºèªç¶²é æ¨™é¡Œä¸­æ˜¯å¦åŒ…å« â€œPlaywrightâ€ é€™å€‹å­—ã€‚</p>
</li>
<li>
<p><code>GetStartedLink()</code><br>
ä¸€æ¨£æ˜¯æ‰“é–‹ Playwright å®˜æ–¹ç¶²ç«™ï¼Œé»æ“Šä¸€å€‹åç‚º â€œGet startedâ€ çš„é€£çµï¼Œç„¶å¾Œæª¢æŸ¥é»æ“Šå¾Œçš„é é¢æ˜¯å¦æœ‰ä¸€å€‹åç‚º â€œInstallationâ€ çš„æ¨™é¡Œï¼Œä»¥ç¢ºä¿é€£çµæ­£ç¢ºå°å‘åˆ°é æœŸçš„é é¢ã€‚</p>
</li>
</ul>
<p>å¤§å®¶æ‡‰è©²ä¸é›£ç™¼ç¾ Playwright çš„ç¨‹å¼ç¢¼å¾ˆç›´è¦ºæ˜“è®€ï¼Œé€šå¸¸ä¹Ÿä¸å¤ªéœ€è¦å¤¾é›œ CSS class æˆ– style ä¾†å°‹æ‰¾å®šä½ç¶²é ä¸Šçš„å…ƒç´ ï¼Œé™¤æ­¤ä¹‹å¤–é‚„æä¾›äº†è±å¯Œçš„ API ä¾†é€²è¡Œå„ç¨®æ“ä½œï¼Œå¦‚ï¼šé»æ“Šã€è¼¸å…¥æ–‡å­—ã€æˆªåœ–ç­‰ï¼Œä¹‹å¾Œå†é™¸çºŒå‘å¤§å®¶ä»‹ç´¹å„é …é‡é»ç‰¹è‰²ï¼Œå¸Œæœ›å¤§å®¶ä¹Ÿéƒ½èƒ½å¿«é€Ÿä¸Šæ‰‹ Playwrightï¼Œä¸¦åœ¨æ—¥å¸¸é–‹ç™¼ä¸­æå‡æ¸¬è©¦æ•ˆç‡èˆ‡ç¨‹å¼ç¢¼å“è³ªã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Text.RegularExpressions;</span><br><span class="line"><span class="keyword">using</span> System.Threading.Tasks;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Playwright;</span><br><span class="line"><span class="keyword">using</span> Microsoft.Playwright.MSTest;</span><br><span class="line"><span class="keyword">using</span> Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">PlaywrightTests</span>;</span><br><span class="line"></span><br><span class="line">[<span class="meta">TestClass</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ExampleTest</span> : <span class="title">PageTest</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">TestMethod</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">HasTitle</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> Page.GotoAsync(<span class="string">&quot;https://playwright.dev&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Expect a title &quot;to contain&quot; a substring.</span></span><br><span class="line">        <span class="keyword">await</span> Expect(Page).ToHaveTitleAsync(<span class="keyword">new</span> Regex(<span class="string">&quot;Playwright&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">TestMethod</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">async</span> Task <span class="title">GetStartedLink</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">await</span> Page.GotoAsync(<span class="string">&quot;https://playwright.dev&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Click the get started link.</span></span><br><span class="line">        <span class="keyword">await</span> Page.GetByRole(AriaRole.Link, <span class="keyword">new</span>() &#123; Name = <span class="string">&quot;Get started&quot;</span> &#125;).ClickAsync();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Expects page to have a heading with the name of Installation.</span></span><br><span class="line">        <span class="keyword">await</span> Expect(Page.GetByRole(AriaRole.Heading, <span class="keyword">new</span>() &#123; Name = <span class="string">&quot;Installation&quot;</span> &#125;)).ToBeVisibleAsync();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>Unit Test</tag>
        <tag>Playwright</tag>
      </tags>
  </entry>
  <entry>
    <title>MSTest ç”Ÿå‘½é€±æœŸèˆ‡å¸¸ç”¨å±¬æ€§</title>
    <url>/post/2025/04/mstest-attribute-lifecycle/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/09/mstest-attribute-lifecycle/MSTest.png"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>åœ¨è»Ÿé«”é–‹ç™¼éç¨‹ä¸­ï¼Œå¦¥å–„é€²è¡Œæ¸¬è©¦å¯ä»¥å”åŠ©æˆ‘å€‘ç¢ºä¿ç¨‹å¼ç¢¼çš„åŠŸèƒ½æ€§èˆ‡å¯é æ€§ï¼Œä¸è«–æ˜¯æœ€å°ç¯„åœçš„<strong>å–®å…ƒæ¸¬è©¦ (Unit Tests)</strong> æˆ–æ˜¯æ¨¡æ“¬å¯¦éš›ç”¨æˆ¶çš„<strong>ç«¯å°ç«¯æ¸¬è©¦(E2E Tests)</strong>ï¼Œéƒ½æ˜¯å“è³ªæŠŠé—œçš„é‡è¦é˜²ç·šï¼Œè€Œ MSTest é™¤äº†è¢«æ•´åˆåœ¨ Visual Studio ä¸­ï¼Œç°¡åŒ–äº† .NET æ‡‰ç”¨ç¨‹å¼å»ºç«‹å’ŒåŸ·è¡Œå–®å…ƒæ¸¬è©¦çš„éç¨‹ï¼Œä¹Ÿå¯ä»¥é€é Azure Pipelines å°‡æ—¢æœ‰çš„æ¸¬è©¦å°ˆæ¡ˆæ•´åˆåˆ° CI æµç¨‹è£¡ï¼Œé€™ç¯‡ä¸»è¦å¸¶å¤§å®¶ç­è§£ MSTest ç”Ÿå‘½é€±æœŸä»¥åŠå¸¸ç”¨å±¬æ€§ï¼Œä»¥ä¾¿å¤§å®¶æ›´èƒ½æŒæ¡è‡ªå·±çš„æ¸¬è©¦æµç¨‹ã€‚</p>
<span id="more"></span>
<br>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p><strong>æ¸¬è©¦é¡åˆ¥(TestClass)</strong> å’Œ <strong>æ¸¬è©¦æ–¹æ³•(TestMethod)</strong> æ˜¯ MSTest æ ¸å¿ƒè¦ç´ ï¼Œä¸€å€‹ TestClass å¯ä»¥åŒ…å«ä¸€å€‹æˆ–å¤šå€‹ TestMethodï¼Œè€Œæˆ‘å€‘å¯¦éš›è¦åŸ·è¡Œæ¸¬è©¦çš„å…§å®¹å°±æ˜¯å¯«åœ¨æ¯å€‹ TestMethod è£¡ï¼Œä¸€èˆ¬å¤§å®¶æ¯”è¼ƒç†ŸçŸ¥çš„ 3A Principle (<strong>A</strong>rrange-<strong>A</strong>ct-<strong>A</strong>ssert) å¯ä»¥å¹«åŠ©æˆ‘å€‘å¿«é€Ÿèšç„¦æ¸¬è©¦æ–¹æ³•è£¡é¢è©²æ’°å¯«çš„å…§å®¹ï¼Œç°¡å–®ç¯„ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line">[<span class="meta">TestClass</span>]</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyTestClass</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">TestMethod</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod1</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Arrange: åˆå§‹åŒ–æ¸¬è©¦éç¨‹ä¸­æ‰€éœ€è¦çš„è®Šæ•¸ã€ç‰©ä»¶æˆ–å…¶ä»–è¨­å®šã€‚</span></span><br><span class="line">        <span class="built_in">int</span> a = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">int</span> b = <span class="number">2</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// Act: å¯¦éš›æ¸¬è©¦æ“ä½œã€å…§å®¹ã€‚</span></span><br><span class="line">        <span class="built_in">int</span> ans = a + b;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Assert: é©—è­‰æ“ä½œæ˜¯å¦ç”¢ç”Ÿé æœŸçµæœã€‚</span></span><br><span class="line">        <span class="built_in">int</span> excepted = <span class="number">3</span>;</span><br><span class="line">        Assert.AreEqual(expected, actual);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æ¸¬è©¦çµ„ä»¶">æ¸¬è©¦çµ„ä»¶</h2>
<p>ä¸€å€‹ MSTest å°ˆæ¡ˆå»ºç½®å®Œæˆå¾Œæœƒç”¢ç”Ÿä¸€å€‹çµ„ä»¶(Assembly)ï¼Œç™½è©±ä¾†èªªå°±æ˜¯ bin ç›®éŒ„çš„ dll æª”æ¡ˆï¼Œå…¶ä¸­å¯ä»¥åŒ…å«å¤šå€‹ TestClassï¼Œè€Œä¸€å€‹ TestClass è£¡å¯ä»¥æœ‰å„è‡ªçš„ TestMethod (å±¤ç´šå¦‚ä¸‹åœ–)ï¼Œæ­¤å¤–ï¼Œæˆ‘å€‘æœƒä½¿ç”¨ <strong><code>[TestClass]</code></strong> å’Œ <strong><code>[TestMethod]</code></strong> å±¬æ€§é …ç›®åœ¨ MSTest å°ˆæ¡ˆæ¨™è¨˜ç¨‹å¼ç¢¼ä¸­å“ªäº›æ˜¯æ¸¬è©¦é¡åˆ¥èˆ‡æ¸¬è©¦æ–¹æ³•ï¼Œä¸‹åˆ—å››ç¨®å¯«æ³•éƒ½ä»£è¡¨ç›¸åŒçš„æ„æ€ï¼š</p>
<ul>
<li>[TestClass()]</li>
<li>[TestClassAttribute()]</li>
<li>[TestClass]</li>
<li>[TestClassAttribute]</li>
</ul>
<div style="max-width: 800px; text-align:center;">
<pre class="mermaid">flowchart LR
  subgraph æ¸¬è©¦çµ„ä»¶ Assembly 
    subgraph æ¸¬è©¦é¡åˆ¥ TestClass 
        subgraph æ¸¬è©¦æ–¹æ³• TestMethod 
            Test1 --> Test2 --> TestN
        end
    end    
  end</pre>
</div>
<h2 id="ç”Ÿå‘½é€±æœŸ">ç”Ÿå‘½é€±æœŸ</h2>
<p>ç•¶æˆ‘å€‘å¯¦éš›åœ¨æ’°å¯«æˆ–åŸ·è¡Œå¤šå€‹æ¸¬è©¦æ™‚ï¼Œç¶“å¸¸éœ€è¦åœ¨ä¸åŒæƒ…å¢ƒæ™‚åˆå§‹åŒ–æˆ–æ¸…é™¤æ¸¬è©¦è³‡æ–™ï¼Œè€Œä¸Šè¿°æåˆ°çš„ <strong>çµ„ä»¶å±¤ç´š</strong> / <strong>é¡åˆ¥å±¤ç´š</strong> / <strong>æ¸¬è©¦å±¤ç´š</strong> éƒ½æä¾›äº† <mark>Initialize</mark> å’Œ <mark>Cleanup</mark> å±¬æ€§è®“æˆ‘å€‘å¯ä»¥åœ¨é©ç•¶çš„æ™‚æ©Ÿæœƒè™•ç†å°æ‡‰çš„é‚è¼¯ã€‚åœ¨ä¸‹åˆ—ç¯„ä¾‹ç¨‹å¼ä¸­ï¼šTestProject1 çµ„ä»¶ä¸­åŒ…å«äº†å…©å€‹é¡åˆ¥ï¼šCalculator(åŠ æ³•ã€æ¸›æ³•é‹ç®—)ï¼ŒCaculatorTests(æ¸¬è©¦é¡åˆ¥)ï¼Œåœ¨æ¸¬è©¦é¡åˆ¥ä¸­æ’°å¯«äº†å…©å€‹ TestMethod (Test_AddMethod å’Œ Test_SubtractMethod)ï¼ŒåŒæ™‚ä¹ŸåŠ ä¸Šäº† Constructor / Disposeã€AssemblyInit / AssemblyCleanupã€ClassInit / Cleanupã€TestInit / TestCleanupï¼Œå¤§å®¶æ‡‰è©²ä¸é›£ç™¼ç¾ï¼Œé€™äº›å‡½å¼éƒ½æ˜¯æˆå°çš„ï¼Œå¯ä»¥ç›´æ¥åƒè€ƒä¸‹åˆ—ç¯„ä¾‹ç¨‹å¼ç¢¼èˆ‡åŸ·è¡Œçµæœï¼Œç­è§£ä¸€å€‹æ¸¬è©¦çµ„ä»¶å¾é–‹å§‹åŸ·è¡Œåˆ°çµæŸæ­·ç¶“äº†å“ªäº›éšæ®µã€‚</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> System.Diagnostics;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TestProject1</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> a + b;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">Subtract</span>(<span class="params"><span class="built_in">int</span> a, <span class="built_in">int</span> b</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">return</span> a - b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    [<span class="meta">TestClass</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">CalculatorTests</span> : <span class="title">IDisposable</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">static</span> Calculator calculator;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">CalculatorTests</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;CalculatorTests - Constructor&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ•´å€‹æ¸¬è©¦ç¨‹åºé›†é–‹å§‹æ™‚åŸ·è¡Œä¸€æ¬¡</span></span><br><span class="line">        [<span class="meta">AssemblyInitialize</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssemblyInit</span>(<span class="params">TestContext context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;AssemblyInitialize: æ¸¬è©¦ç¨‹åºé›†åˆå§‹åŒ–ã€‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ‰€æœ‰æ¸¬è©¦åŸ·è¡Œå‰åˆå§‹åŒ–ï¼ŒåªåŸ·è¡Œä¸€æ¬¡</span></span><br><span class="line">        [<span class="meta">ClassInitialize</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ClassInit</span>(<span class="params">TestContext context</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;ClassInitialize: åˆå§‹åŒ– Calculator é¡åˆ¥å¯¦ä¾‹ã€‚&quot;</span>);</span><br><span class="line">            calculator = <span class="keyword">new</span> Calculator();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ¯å€‹æ¸¬è©¦æ–¹æ³•åŸ·è¡Œå‰èª¿ç”¨</span></span><br><span class="line">        [<span class="meta">TestInitialize</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestInit</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;TestInitialize: é–‹å§‹åŸ·è¡Œæ–°çš„æ¸¬è©¦ã€‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¸¬è©¦åŠ æ³•åŠŸèƒ½</span></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        [<span class="meta">TestCategory(<span class="string">&quot;CalculatorTests&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test_AddMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;Test_AddMethod: æ¸¬è©¦åŠ æ³•é‹ç®—ã€‚&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> result = calculator.Add(<span class="number">5</span>, <span class="number">3</span>);</span><br><span class="line">            Assert.AreEqual(<span class="number">8</span>, result, <span class="string">&quot;åŠ æ³•çµæœä¸æ­£ç¢º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¸¬è©¦æ¸›æ³•åŠŸèƒ½</span></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        [<span class="meta">TestCategory(<span class="string">&quot;CalculatorTests&quot;</span>)</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Test_SubtractMethod</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;Test_SubtractMethod: æ¸¬è©¦æ¸›æ³•é‹ç®—ã€‚&quot;</span>);</span><br><span class="line">            <span class="built_in">int</span> result = calculator.Subtract(<span class="number">10</span>, <span class="number">5</span>);</span><br><span class="line">            Assert.AreEqual(<span class="number">5</span>, result, <span class="string">&quot;æ¸›æ³•çµæœä¸æ­£ç¢º&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ¯å€‹æ¸¬è©¦æ–¹æ³•åŸ·è¡Œå¾Œèª¿ç”¨</span></span><br><span class="line">        [<span class="meta">TestCleanup</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestCleanup</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;TestCleanup: æ¸¬è©¦å®Œæˆï¼Œæ¸…ç†æ¸¬è©¦ä¸Šä¸‹æ–‡ã€‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ‰€æœ‰æ¸¬è©¦åŸ·è¡Œå®Œç•¢å¾Œæ¸…ç†ï¼ŒåªåŸ·è¡Œä¸€æ¬¡</span></span><br><span class="line">        [<span class="meta">ClassCleanup</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">ClassCleanup</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;ClassCleanup: æ¸…ç† Calculator é¡åˆ¥å¯¦ä¾‹ã€‚&quot;</span>);</span><br><span class="line">            <span class="comment">//calculator = null;</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ•´å€‹æ¸¬è©¦ç¨‹åºé›†çµæŸæ™‚åŸ·è¡Œä¸€æ¬¡</span></span><br><span class="line">        [<span class="meta">AssemblyCleanup</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">AssemblyCleanup</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;AssemblyCleanup: æ¸¬è©¦ç¨‹åºé›†æ¸…ç†ã€‚&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Dispose</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Debug.WriteLine(<span class="string">&quot;CalculatorTests - Dispose&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/mstest-attribute-lifecycle/console-run-test.png"
                        class=""
                 >
<h2 id="å¸¸ç”¨å±¬æ€§">å¸¸ç”¨å±¬æ€§</h2>
<h3 id="é€¾æ™‚è¨­å®š-TimeoutAttribute">é€¾æ™‚è¨­å®š TimeoutAttribute</h3>
<p><strong><code>TimeoutAttribute</code></strong> ç”¨æ–¼è¨­å®šæ¸¬è©¦æ–¹æ³•çš„æœ€å¤§åŸ·è¡Œæ™‚é–“ï¼ˆä»¥<strong>æ¯«ç§’</strong>ç‚ºå–®ä½ï¼‰ã€‚å¦‚æœåŸ·è¡Œæ¸¬è©¦è¶…éæŒ‡å®šçš„æ™‚é–“é™åˆ¶ï¼Œæ¸¬è©¦å‰‡æœƒå¤±æ•—ï¼Œé€™å€‹å±¬æ€§å¯ä»¥è®“æˆ‘å€‘é¿å…æ¸¬è©¦åŸ·è¡Œæ™‚é–“éé•·ï¼Œæˆ–æ˜¯ç‚ºæŸäº›æ¸¬è©¦æƒ…å¢ƒè¨­å®šä¸€å€‹é€¾æ™‚æœŸé™ï¼Œå¦‚ä¸‹ç¯„ä¾‹ï¼š</p>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TestProject1</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">TestClass</span>]</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">TimeoutExampleTests</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// é€™å€‹æ¸¬è©¦æœƒåœ¨ 500 æ¯«ç§’å…§å®Œæˆï¼Œæ‰€ä»¥å®ƒæœƒé€šé</span></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        [<span class="meta">Timeout(1000)</span>]  <span class="comment">// è¨­ç½® 1 ç§’çš„è¶…æ™‚</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod_WithSufficientTime</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(<span class="number">500</span>);  <span class="comment">// æ¨¡æ“¬è¼ƒçŸ­çš„è™•ç†æ™‚é–“</span></span><br><span class="line">            Assert.AreEqual(<span class="number">4</span>, <span class="number">2</span> + <span class="number">2</span>);  <span class="comment">// å‡è¨­é€™æ˜¯æ¸¬è©¦é‚è¼¯</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é€™å€‹æ¸¬è©¦æœƒå› ç‚ºè¶…æ™‚è€Œå¤±æ•—</span></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        [<span class="meta">Timeout(1000)</span>]  <span class="comment">// è¨­ç½® 1 ç§’çš„è¶…æ™‚</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod_WithTimeout</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(<span class="number">1500</span>);  <span class="comment">// æ¨¡æ“¬è¶…é1ç§’çš„è™•ç†æ™‚é–“</span></span><br><span class="line">            Assert.AreEqual(<span class="number">4</span>, <span class="number">2</span> + <span class="number">2</span>);  <span class="comment">// å‡è¨­é€™æ˜¯æ¸¬è©¦é‚è¼¯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="å¹³è¡Œæ¸¬è©¦-ParallelizeAttribute">å¹³è¡Œæ¸¬è©¦ ParallelizeAttribute</h3>
<p>è‡ª MSTest v2 èµ·ï¼Œæä¾›äº†å…©å€‹é—œæ–¼å¹³è¡Œæ¸¬è©¦çš„å±¬æ€§ï¼š</p>
<ul>
<li><strong><code>ParallelizeAttribute</code></strong>ï¼šå¯ä»¥æ‡‰ç”¨æ–¼é¡åˆ¥æˆ–æ¸¬è©¦é›†ä¾†å•Ÿç”¨å¹³è¡Œæ¸¬è©¦ã€‚</li>
<li><strong><code>DoNotParallelizeAttribute</code></strong>ï¼šå¯ä»¥æ‡‰ç”¨æ–¼å€‹åˆ¥æ¸¬è©¦æ–¹æ³•ä¾†<mark>ç¦æ­¢</mark>å®ƒèˆ‡å…¶ä»–æ¸¬è©¦ä¸¦è¡ŒåŸ·è¡Œã€‚</li>
</ul>
<figure class="highlight csharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">using</span> Microsoft.VisualStudio.TestTools.UnitTesting;</span><br><span class="line"><span class="keyword">using</span> System.Threading;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">TestProject1</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">TestClass</span>]</span><br><span class="line">    [<span class="meta">Parallelize(Workers = 2, Scope = ExecutionScope.MethodLevel)</span>]  <span class="comment">// å•Ÿç”¨ä¸¦è¡Œï¼ŒæŒ‡å®šæœ€å¤šå…©å€‹å·¥ä½œç·šç¨‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ParallelTests</span></span><br><span class="line">    &#123;</span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod1</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(<span class="number">1000</span>);  <span class="comment">// æ¨¡æ“¬å·¥ä½œ</span></span><br><span class="line">            Assert.AreEqual(<span class="number">4</span>, <span class="number">2</span> + <span class="number">2</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod2</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(<span class="number">1000</span>);  <span class="comment">// æ¨¡æ“¬å·¥ä½œ</span></span><br><span class="line">            Assert.AreEqual(<span class="number">9</span>, <span class="number">3</span> * <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç¦æ­¢é€™å€‹æ–¹æ³•èˆ‡å…¶ä»–æ¸¬è©¦ä¸¦è¡ŒåŸ·è¡Œ</span></span><br><span class="line">        [<span class="meta">TestMethod</span>]</span><br><span class="line">        [<span class="meta">DoNotParallelize</span>]</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">TestMethod3_DoNotParallelize</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Thread.Sleep(<span class="number">1000</span>);  <span class="comment">// æ¨¡æ“¬å·¥ä½œ</span></span><br><span class="line">            Assert.AreEqual(<span class="number">15</span>, <span class="number">5</span> * <span class="number">3</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>[Parallelize(Workers = 2, Scope = ExecutionScope.MethodLevel)]</code></strong>ï¼š
<ul>
<li>Workers = 2 è¡¨ç¤ºæœ€å¤šä½¿ç”¨ 2 å€‹åŸ·è¡Œç·’ä¾†åŸ·è¡Œå¹³è¡Œæ¸¬è©¦ã€‚</li>
<li>Scope = ExecutionScope.MethodLevel è¡¨ç¤ºåœ¨æ–¹æ³•å±¤ç´šå¹³è¡Œæ¸¬è©¦ï¼Œä»£è¡¨æ¯å€‹æ¸¬è©¦æ–¹æ³•å¯ä»¥å¹³è¡ŒåŸ·è¡Œï¼›å¦‚æœæƒ³è¦åœ¨é¡åˆ¥å±¤ç´šï¼Œå¯ä»¥è¨­å®šç‚º ExecutionScope.ClassLevelã€‚</li>
</ul>
</li>
<li>TestMethod1 å’Œ TestMethod2ï¼š<br>
å› ç‚ºé¡åˆ¥å±¤ç´šå·²ç¶“ä½¿ç”¨ Parallelize å±¬æ€§ï¼Œä¸¦ä¸”è¨­å®š Workers = 2 è¡¨ç¤ºé€™å…©å€‹æ¸¬è©¦æ–¹æ³•æœƒåœ¨åŸ·è¡Œç·’æ± è£¡å¹³è¡ŒåŸ·è¡Œã€‚</li>
<li>TestMethod3_DoNotParallelizeï¼š<br>
é€™å€‹æ–¹æ³•åŠ äº† <strong><code>[DoNotParallelize]</code></strong>ï¼Œæ‰€ä»¥å®ƒ<mark>ä¸æœƒ</mark>èˆ‡å…¶ä»–æ–¹æ³•åŒæ™‚åŸ·è¡Œï¼Œç•¶ TestMethod3_DoNotParallelize åŸ·è¡Œæ™‚ï¼Œå…¶ä»–å¹³è¡Œæ¸¬è©¦æœƒæš«åœï¼Œç›´åˆ°é€™å€‹æ¸¬è©¦å®Œæˆã€‚</li>
</ul>
<h2 id="å¾Œè¨˜">å¾Œè¨˜</h2>
<p>MSTest å¾æ¨å‡ºè‡³ä»Šå·²ç¶“ä¾†åˆ°äº† v3ï¼Œå¾ä¸€é–‹å§‹åªèƒ½åœ¨ Windows å¹³å°ä¸Šé‹ä½œï¼Œéš¨è‘— .NET Framework çš„æ¼”é€²ï¼Œä¹Ÿé€æ­¥æ”¯æ´è·¨å¹³å°é‹è¡Œï¼Œç‰¹åˆ¥æ˜¯åœ¨ .NET Core å’Œ .NET 5 ä¹‹å¾Œï¼ŒMSTest æˆç‚ºäº† .NET ç”Ÿæ…‹ç³»ä¸­ä¸€å€‹å¯é ä¸”ç°¡å–®æ˜“ç”¨çš„æ¸¬è©¦æ¡†æ¶ã€‚å®ƒä¸åƒ…é©åˆå¿«é€Ÿæ’°å¯«å–®å…ƒæ¸¬è©¦ï¼Œé‚„èƒ½èˆ‡å¤šç¨®æŒçºŒæ•´åˆå’Œéƒ¨ç½²å·¥å…·ç„¡ç¸«çµåˆï¼Œä¾‹å¦‚ï¼šAzure DevOps å’Œ GitHub Actionsã€‚</p>
<p>ç”±æ–¼æ‡‰ç”¨ç¨‹å¼è¤‡é›œåº¦æ—¥ç›Šæé«˜ï¼ŒMSTest å¾ v2 é–‹å§‹ä¹Ÿæä¾›äº†å¹³è¡Œæ¸¬è©¦ï¼Œå…è¨±å¤šå€‹æ¸¬è©¦åŒæ™‚åŸ·è¡Œï¼Œé€™ä¸åƒ…åŠ å¿«äº†æ¸¬è©¦é€Ÿåº¦ï¼Œä¹Ÿæé«˜äº† CI/CD çš„æ•ˆèƒ½ã€‚å¹³è¡Œæ¸¬è©¦ä½¿é–‹ç™¼äººå“¡èƒ½å¤ åœ¨ä¸å½±éŸ¿æ¸¬è©¦å®Œæ•´æ€§çš„å‰æä¸‹ï¼Œé¡¯è‘—ç¸®çŸ­æ¸¬è©¦é€±æœŸï¼Œå°å¤§å‹å°ˆæ¡ˆå°¤ç‚ºé‡è¦ã€‚æ­¤å¤–ï¼ŒMSTest ä¹ŸåŒ…å«ï¼šæ•¸æ“šé©…å‹•æ¸¬è©¦ã€ç”Ÿå‘½é€±æœŸç®¡ç†ã€ç•°å¸¸è™•ç†æ¸¬è©¦ç­‰ï¼Œé€™è®“æˆ‘å€‘èƒ½å¤ æ›´å…¨é¢åœ°é©—è­‰æ‡‰ç”¨ç¨‹å¼çš„åŠŸèƒ½å’Œæ•ˆèƒ½ã€‚</p>
<p>MSTest çš„æ˜“ç”¨æ€§ä½¿å¾—å®ƒé©åˆä¸åŒè¦æ¨¡çš„å°ˆæ¡ˆï¼ŒåŠ ä¸Š Visual Studio é–‹ç™¼å·¥å…·èˆ‡ Azure DevOps Services çš„æ”¯æ´ï¼Œä¸è«–æ˜¯å°å‹é–‹ç™¼åœ˜éšŠæˆ–æ˜¯å¤§å‹ä¼æ¥­æ‡‰ç”¨ï¼Œéƒ½èƒ½è¼•é¬†æ¡ç”¨ï¼Œç‚ºè»Ÿé«”é–‹ç™¼å°ˆæ¡ˆå“è³ªæŠŠé—œï¼Œä¹Ÿè®“æ•´å€‹ DevOps æµç¨‹æ›´åŠ å®Œå–„ã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://github.com/microsoft/testfx"  target="_blank">â Microsoft Test Framework<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/dotnet/core/testing/unit-testing-with-mstest?source=recommendations"  target="_blank">â ä½¿ç”¨ MSTest å’Œ .NET é€²è¡Œ C# å–®å…ƒæ¸¬è©¦<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/dotnet/core/testing/unit-testing-mstest-writing-tests-attributes"  target="_blank">â MSTest å±¬æ€§<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://www.meziantou.net/mstest-v2-setup-a-test-project-and-run-tests.htm"  target="_blank">â MSTest v2: Setup a test project and run tests<i class="fas fa-external-link-alt"></i></a>
</font>
</div>]]></content>
      <tags>
        <tag>MSTest</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ VB5/VB6 é€£ç·šè‡³ Azure DevOps Server 2022 (TFVC)</title>
    <url>/post/2025/04/vb-connect-to-azure-devops/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/10/vb-connect-to-azure-devops/VS_TFS.png"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p>Visual Studio å¾ 97 ç™¼å±•åˆ°ç¾åœ¨çš„ 2022 è™Ÿç¨±åœ°è¡¨æœ€å¼·é–‹ç™¼å·¥å…·ï¼Œèƒ½å¤ èˆ‡ TFS æˆ– Git ç‰ˆæ§é€£ç·šè‡ªç„¶ä¸æ˜¯å•é¡Œï¼Œæœ€è¿‘å‰›å¥½é‡åˆ°å®¢æˆ¶é‚„æœ‰è¨±å¤š VB5/VB6 é–‹ç™¼çš„ Winform ç¨‹å¼éœ€è¦ç¶­è­·ï¼Œè€Œä¸”ç‰ˆæ§ä¼ºæœå™¨ä¹Ÿå¾ TFS 2013 å‡ç´šè‡³ Azure DevOps Server 2022ï¼Œè—‰æ­¤æ©Ÿæœƒå‘å¤§å®¶æ•´ç†èªªæ˜ Visual Studio å„ç‰ˆæœ¬èˆ‡ TFS / Azure DevOps é€£ç·šçš„éœ€æ±‚èˆ‡è¨­å®šã€‚<br>
<br></p>
<span id="more"></span>
<br>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æˆ‘å€‘ä½¿ç”¨ Visual Studio é–‹ç™¼å·¥å…·èƒ½å¤ èˆ‡ TFS é€£ç·šæ˜¯å› ç‚ºå®ƒçš„åŠŸèƒ½åŒ…å«äº† <strong><code>Team Explorer</code></strong>ï¼Œæ˜ç¢ºä¾†èªªæ˜¯å¾ Visual Studio 2005 é¦–æ¬¡å¼•å…¥ TFS (Team Foundation Server) èµ·æ‰é–‹å§‹åŒ…å«æ­¤åŠŸèƒ½ï¼Œåœ¨é€™å€‹ç‰ˆæœ¬ä¹‹å‰å‰‡éœ€è¦é¡å¤–å®‰è£ <strong>Team Explorer</strong> å’Œ <strong>MSSCCI Provider</strong> (Microsoft Source Code Control Integration) æ‰èƒ½å¤ åœ¨é–‹ç™¼å·¥å…·ä¸­èˆ‡ TFS é€²è¡Œæ•´åˆã€‚</p>
<h2 id="ç‰ˆæœ¬ç›¸ä¾æ€§">ç‰ˆæœ¬ç›¸ä¾æ€§</h2>
<p>ä½œæ¥­ç³»çµ±ã€é–‹ç™¼å·¥å…·èˆ‡ç‰ˆæ§ä¼ºæœå™¨å½¼æ­¤é–“æœ‰ä¸€å®šçš„ç‰ˆæœ¬ç›¸ä¾æ€§ï¼ŒWindows XP ç„¡æ³•å®‰è£ Team Explorer 2013ï¼Œåªèƒ½å®‰è£ Team Explorer 2010ï¼Œæ­é… MSSCCI Provider 2010 å¯ä»¥é€£ç·šçš„ç‰ˆæœ¬æœ‰ï¼šTFS 2005 ~ 2018 å’Œ Azure DevOps Server 2019/2020 <mark>(ä¸åŒ…å«2022)</mark>ï¼Œè‹¥èˆŠé–‹ç™¼ç’°å¢ƒ (Visual Studio 2013 ä»¥å‰) æƒ³è¦èˆ‡ Azure DevOps Server 2022 é€£ç·šï¼Œå¿…è¦æœ€ä½é–€æª»å¯ä»¥åƒè€ƒä¸‹åˆ—é…ç½®ï¼š</p>
<ul>
<li><strong>Windows 7 ä»¥ä¸Š</strong></li>
<li><strong>Team Explorer 2013</strong></li>
<li><strong>MSSCCI Provider 2013</strong></li>
</ul>
<p>Visual Studio 97/6/2003~2008 æ­é… Team Explorer 2010 + MSSCCI Provider 2010 å¯ä»¥å¾é–‹ç™¼å·¥å…·é€£ç·šè‡³ TFS 2010~2017 å’Œ Azure DevOps Server 2019/2020ï¼Œè‹¥è¦é€£ç·šè‡³ Azure DevOps Server 2022 å‰‡éœ€è¦æ­é… Team Explorer 2013 + MSSCCI Provider 2013 æ‰è¡Œï¼Œå„ç‰ˆæœ¬ MSSCCI Provider å¯ä»¥è‡ª Visual Studio | Marketplace å–å¾—ï¼š</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer2010MSSCC"  target="_blank">â Microsoft Visual Studio Team Foundation Server 2010 MSSCCI Provider 32-bit<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer2012MSSCC"  target="_blank">â Microsoft Visual Studio Team Foundation Server 2012 MSSCCI Provider 32-bit<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer20132015M"  target="_blank">â Microsoft Visual Studio Team Foundation Server 2013&2015 MSSCCI Provider 32-bit<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.TeamFoundationServerMSSCCIProvider201064-bit"  target="_blank">â Team Foundation Server MSSCCI Provider 2010 64-bit<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer2012MSSCC-9956"  target="_blank">â Microsoft Visual Studio Team Foundation Server 2012 MSSCCI Provider 64-bit<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://marketplace.visualstudio.com/items?itemName=TFSPowerToolsTeam.MicrosoftVisualStudioTeamFoundationServer20132015M-11387"  target="_blank">â Microsoft Visual Studio Team Foundation Server 2013&2015 MSSCCI Provider 64-bit<i class="fas fa-external-link-alt"></i></a><br>
</font>
</div>
<h2 id="VB5-VB6">VB5/VB6</h2>
<p>åœ¨ VB5/VB6 çš„å·¥å…·åˆ—éœ€è¦é¡å¤–å®‰è£ä¸Šè¿°æåˆ°çš„ MSSCCI Provider 2010/2013 æ‰æœƒå‡ºç¾ <strong>Team Foundation</strong> é¸é …ï¼Œè®“æˆ‘å€‘åœ¨é–‹ç™¼å·¥å…·ä¸­å°‡ç¨‹å¼ç¢¼èˆ‡ç‰ˆæ§ä¼ºæœå™¨æ•´åˆã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/vb-connect-to-azure-devops/create-project-from-tfs.png"
                        class=""
                 >
<p>è‹¥å‡ºç¾ä¸‹åˆ—éŒ¯èª¤è¨Šæ¯ï¼Œå°±æ˜¯ MSSCCI Provider ç‰ˆæœ¬å¤ªèˆŠäº†ï¼Œç„¡æ³•é€£ç·šåˆ°æ–°çš„ç‰ˆæ§ä¼ºæœå™¨ï¼Œä¾‹å¦‚ï¼šå®‰è£ MSSCCI Provider 2010 ä½†æƒ³è¦èˆ‡ Azure DevOps Server 2022 é€£ç·šï¼Œå”¯ä¸€è§£æ³•å°±æ˜¯å®‰è£ Team Explorer 2013 + MSSCCI Provider 2013ã€‚</p>
<blockquote>
<p>TF14045: The identity ä¸»æ©Ÿåç¨±\2ffd15ae-91e4-4df8-a346-e5be57e1340e is not a recognized identity.</p>
</blockquote>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/04/vb-connect-to-azure-devops/not-a-recognized-identity.png"
                        class=""
                 >
<p>åœ¨å¯¦å‹™æƒ…å¢ƒå¯èƒ½é‚„æœƒé‡åˆ°å…¶ä»–å„ç¨®ç‰ˆæœ¬çµ„åˆï¼Œç¶“æ­¤æ¬¡å˜—è©¦å¾Œï¼Œç¢ºèª VB5/VB6 éƒ½é‚„å¯ä»¥èˆ‡ Azure DevOps Server 2022 çš„ TFVC ç‰ˆæ§é€²è¡Œæ•´åˆï¼Œé€™é‚Šæœ‰ç¯‡æ–‡ç« å°‡å„ç¨®çµ„åˆæ¢åˆ—å¾—å¾ˆè©³ç›¡ï¼Œä¹Ÿæä¾›å¤§å®¶åƒè€ƒã€‚</p>
<div class="tips">
<font color="black">
<a class="link"   href="https://jessehouwing.net/azure-devops-connect-any-visual-studio-version/"  target="_blank">â Connect any version of Visual Studio to Azure DevOps or Azure DevOps Server<i class="fas fa-external-link-alt"></i></a><br>
</font>
</div>
]]></content>
      <tags>
        <tag>VB5</tag>
        <tag>VB6</tag>
        <tag>TFS</tag>
        <tag>Team Explorer</tag>
        <tag>MSSCCI Provider</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ Playwright æ¸¬è©¦æ¡†æ¶ - åŸ·è¡Œéšæ®µ (.NET)</title>
    <url>/post/2025/05/how-to-use-playwright-2/</url>
    <content><![CDATA[<img    
                       lazyload
                       alt="image"
                       data-src="/post/2024/11/how-to-use-playwright-1/playwright.png"
                         align="left" style="margin-right: 10px; width: 125px; border: 1px solid gray;"
                 > 
<p><a href="/post/2024/11/how-to-use-playwright-1">ä¸Šä¸€ç¯‡æ–‡ç« </a>æåˆ°äº†å¦‚ä½•ä½¿ç”¨ Playwright çš„æ¸¬è©¦ç”¢ç”Ÿå™¨(codegen) éŒ„è£½è…³æœ¬ï¼Œé™¤äº†å¯ä»¥é‹ç”¨åœ¨è‡ªå‹•åŒ–æ¸¬è©¦ä¹‹å¤–ï¼Œèˆ‰å‡¡æƒ³è¦é€éç¨‹å¼ä¾†è‡ªå‹•åŸ·è¡Œçš„ä¸€é€£ä¸²è¡Œç‚ºï¼Œéƒ½å¯ä»¥é€é Playwright ä¾†å®Œæˆï¼Œæœ¬ç¯‡æ–‡ç« ä½¿ç”¨ Windows Sandbox å…¨æ–°ç’°å¢ƒä¾†åŸ·è¡Œç”± .NET 8 æ’°å¯«çš„ Console ç¨‹å¼ï¼Œè®“å¤§å®¶çŸ¥é“å»ºç½®ç”¢ç”ŸåŸ·è¡Œæª”å¾Œï¼Œé‚„éœ€è¦å“ªäº›å¿…è¦çš„ç’°å¢ƒè¨­å®šæ‰å¯ä»¥æ­£å¸¸è®“ç¨‹å¼é‹ä½œã€‚<br>
<br></p>
<span id="more"></span>
<br>
<h2 id="å®‰è£-NET-Runtime">å®‰è£ .NET Runtime</h2>
<p>ä¸è«–æ˜¯ä»¥å‰çš„ .NET Framework æˆ–æ˜¯ç¾åœ¨çš„ .NET Coreï¼Œåœ¨åŸ·è¡Œæ™‚éƒ½éœ€è¦å®‰è£ .NET Runtime æ‰èƒ½é †åˆ©é‹è¡Œé–‹ç™¼å¥½çš„ç¨‹å¼ï¼Œä»¥ä¸‹åœ– Console å°ˆæ¡ˆå»ºç½®å¾Œçš„åŸ·è¡Œæª”ç‚ºä¾‹ï¼Œç•«é¢é‚„æœƒå¾ˆè²¼å¿ƒçš„æŒ‡å¼•æˆ‘å€‘ç›®å‰çš„éœ€æ±‚ç‰ˆæœ¬å’Œä¸‹è¼‰è·¯å¾‘ï¼Œå®Œæˆå®‰è£å¾Œä¾¿å¯é †åˆ©åŸ·è¡Œ Console ç¨‹å¼ã€‚</p>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-2/dotnet8.png"
                        class=""
                 >
<br>
<div class="tips">
<font color="black">
<a class="link"   href="https://dotnet.microsoft.com/download"  target="_blank">â ä¸‹è¼‰ .NET<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<h2 id="å®‰è£-PowerShell">å®‰è£ PowerShell</h2>
<p>å¦‚æœæ˜¯å…¨æ–°çš„ç’°å¢ƒï¼Œå®‰è£å®Œ .NET Runtime å¾Œæ‡‰è©²é‚„æœƒå‡ºç¾å¦‚ä¸‹åœ–çš„éŒ¯èª¤ï¼Œä¸»è¦åŸå› æ˜¯ï¼š</p>
<ul>
<li>pwsh æ‰¾ä¸åˆ°è·¯å¾‘ (æˆ–æ˜¯æ²’æœ‰å®‰è£ PowerShell)</li>
<li>ç¼ºå°‘ Web Driver (Edge/Chrome/Firefox)</li>
</ul>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-2/pwsh.png"
                        class=""
                 >
<br>
è‹¥è¦å®‰è£ PowerShell å¯ä»¥ä¾æ“šè‡ªå·±çš„ä½œæ¥­ç³»çµ±åƒè€ƒä¸‹åˆ—é€£çµï¼š
<div class="tips">
<font color="black">
<a class="link"   href="https://learn.microsoft.com/zh-tw/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.5"  target="_blank">â åœ¨ Windows ä¸Šå®‰è£ PowerShell<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/powershell/scripting/install/installing-powershell-on-linux?view=powershell-7.5"  target="_blank">â åœ¨ Linux ä¸Šå®‰è£ PowerShell<i class="fas fa-external-link-alt"></i></a><br>
<a class="link"   href="https://learn.microsoft.com/zh-tw/powershell/scripting/install/installing-powershell-on-macos?view=powershell-7.5"  target="_blank">â åœ¨ macOS ä¸Šå®‰è£ PowerShell<i class="fas fa-external-link-alt"></i></a>
</font>
</div>
<h2 id="å®‰è£-WebDriver">å®‰è£ WebDriver</h2>
<p>åœ¨ä¸Šåœ–çš„éŒ¯èª¤è¨Šæ¯ä¸­æœ‰æåˆ°å¦‚ä¸‹æŒ‡ä»¤ï¼Œè·¯å¾‘ä¸­çš„ netX è¦æ›¿æ›ç‚ºè‡ªå·±ä½¿ç”¨çš„ç‰ˆæœ¬è·¯å¾‘ï¼Œè€Œå…¶ä¸­çš„ playwright.ps1 æœƒå­˜åœ¨æ–¼ .NET ç¨‹å¼å»ºç½®å¾Œçš„ bin ç›®éŒ„ä¸­ï¼Œé€™å€‹ .ps1 çš„ä¸»è¦ç”¨é€”æ˜¯åœ¨ Windows ç’°å¢ƒä¸‹åŸ·è¡Œ Playwright æ¸¬è©¦ï¼Œè®“å®ƒå¯ä»¥æ­£ç¢ºæ‰¾åˆ° Playwright ä¸»ç¨‹å¼å’Œç›¸é—œé©…å‹•ç¨‹å¼ï¼Œç¢ºèª pwsh æŒ‡ä»¤å¯ä»¥é‹ä½œå¾Œï¼Œå°±å¯ä»¥æ¥è‘—å®‰è£ WebDriver äº†ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pwsh bin/Debug/netX/playwright.ps1 install</span><br></pre></td></tr></table></figure>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-2/playwright.png"
                        class=""
                 >
<br>
è‹¥åœ¨ install ä¹‹å¾Œæ²’æœ‰åŠ ä¸Šä»»ä½•åƒæ•¸ï¼Œå‰‡æœƒå®‰è£ä¸‹åˆ—é è¨­é …ç›®ï¼š
<ul>
<li>Chromium</li>
<li>Chromium Headless Shell</li>
<li>Firefox</li>
<li>Webkit</li>
<li>FFMPEG</li>
</ul>
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-2/install.png"
                        class=""
                 >
<br>
ä¹Ÿå¯ä»¥ä¾è‡ªå·±çš„éœ€æ±‚å®‰è£æŒ‡å®šé …ç›®ï¼Œå¯ä½¿ç”¨ install -h æŸ¥çœ‹ç›¸é—œè³‡è¨Šï¼š
<img  
                       lazyload
                       alt="image"
                       data-src="/post/2025/05/how-to-use-playwright-2/custom.png"
                        class=""
                 >
<h2 id="ç¸½çµ">ç¸½çµ</h2>
<p>æœ¬æ–‡ä»‹ç´¹äº†åœ¨å…¨æ–°ç’°å¢ƒä¸‹ï¼Œå¦‚ä½•è®“ .NET 8 æ’°å¯«çš„ Playwright æ¸¬è©¦ç¨‹å¼é †åˆ©åŸ·è¡Œï¼ŒåŒ…å«å®‰è£ .NET Runtimeã€PowerShell åŠ WebDriver ç­‰å¿…è¦æ­¥é©Ÿã€‚åªè¦ä¾ç…§ä¸Šè¿°æµç¨‹å®Œæˆç’°å¢ƒè¨­å®šï¼Œå°±èƒ½é¿å…å¸¸è¦‹çš„éŒ¯èª¤è¨Šæ¯ï¼Œé †åˆ©åŸ·è¡Œè‡ªå‹•åŒ–æ¸¬è©¦ã€‚å¸Œæœ›é€™äº›èªªæ˜èƒ½å¹«åŠ©ä½ åœ¨ä¸åŒå¹³å°ä¸Šå¿«é€Ÿéƒ¨ç½²èˆ‡é‹è¡Œ Playwright æ¸¬è©¦å°ˆæ¡ˆã€‚</p>
]]></content>
      <tags>
        <tag>Playwright</tag>
      </tags>
  </entry>
</search>
